
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Projections &#8212; Jupyter Guide to Linear Algebra</title>
    
  <link rel="stylesheet" href="_static/css/index.d431a4ee1c1efae0e38bdfebc22debff.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.bfb7730f9caf2ec0b46a44615585038c.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.30270b6e4c972e43c488.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Applications of Inner Products" href="Applications_IP.html" />
    <link rel="prev" title="Least Squares Solutions" href="Least_Squares_Solutions.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/reflection_logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Jupyter Guide to Linear Algebra</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Welcome to the Jupyter Guide to Linear Algebra
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="Jupyter_Introduction.html">
   Introduction to Jupyter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Linear_Systems.html">
   Linear Systems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Vector_Spaces.html">
   Vector Spaces
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Linear_Transformations.html">
   Linear Transformations
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="Inner_Products.html">
   Inner Products
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="Orthogonalization.html">
     Orthogonalization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="QR_Factorization.html">
     QR Factorization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Orthogonal_Subspaces.html">
     Orthogonal Subspaces
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Least_Squares_Solutions.html">
     Least Squares Solutions
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Projections
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Applications_IP.html">
     Applications of Inner Products
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Eigenvalues.html">
   Eigenvalues
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Projections.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/bvanderlei/jupyter-guide-to-linear-algebra/main?urlpath=tree/Projections.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/bvanderlei/jupyter-guide-to-linear-algebra/blob/main/Projections.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-1-orthogonal-projection-in-mathbb-r-2">
   Example 1:  Orthogonal Projection in
   <span class="math notranslate nohighlight">
    \(\mathbb{R}^2\)
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-2-nonorthogonal-projection-in-mathbb-r-2">
   Example 2  Nonorthogonal Projection in
   <span class="math notranslate nohighlight">
    \(\mathbb{R}^2\)
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#orthogonal-projections">
   Orthogonal Projections
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <section id="projections">
<h1>Projections<a class="headerlink" href="#projections" title="Permalink to this headline">¶</a></h1>
<p>At the start of the chapter, we considered the projection of one vector onto the direction of another, and how to use that projection to decompose the vector into two orthogonal components.  We then considered the higher dimensional analogy of projecting a vector onto a subspace and, using that projection to decompose the vector into orthogonal components.   In this section, we concentrate these concepts, and consider projections as linear transformations which have applications beyond vector decomposition.</p>
<p>A linear transformation <span class="math notranslate nohighlight">\(T:\mathbb{R}^n \to \mathbb{R}^n\)</span> is a <strong>projection</strong> if <span class="math notranslate nohighlight">\(T\circ T = T\)</span>.  The result of applying a projection once is the same as the result of applying it twice.  We can understand the effect of a projection as the collapsing of a vector in <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> onto a subspace <span class="math notranslate nohighlight">\(\mathcal{V}\)</span>.  Once a vector as been projected onto <span class="math notranslate nohighlight">\(\mathcal{V}\)</span>, any further projection onto <span class="math notranslate nohighlight">\(\mathcal{V}\)</span> has no effect.</p>
<section id="example-1-orthogonal-projection-in-mathbb-r-2">
<h2>Example 1:  Orthogonal Projection in <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span><a class="headerlink" href="#example-1-orthogonal-projection-in-mathbb-r-2" title="Permalink to this headline">¶</a></h2>
<p>We look first at an orthogonal projection onto the <span class="math notranslate nohighlight">\(x_1\)</span>-axis in <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span>.  This transformation <span class="math notranslate nohighlight">\(T:\mathbb{R}^2\to\mathbb{R}^2\)</span> can be defined with the following formula.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
T\left( \left[ \begin{array}{r} x \\ y \end{array} \right]\right) =
\left[ \begin{array}{r} x \\ 0 \end{array} \right]
\end{equation}
\end{split}\]</div>
<p>This projection simply carries all vectors onto the <span class="math notranslate nohighlight">\(x_1\)</span>-axis based on their first entry.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">laguide</span> <span class="k">as</span> <span class="nn">lag</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;head_width&quot;</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span> <span class="s2">&quot;head_length&quot;</span><span class="p">:</span><span class="mf">0.2</span><span class="p">,</span> <span class="s2">&quot;length_includes_head&quot;</span><span class="p">:</span><span class="kc">True</span><span class="p">}</span>

<span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">fc</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">ec</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">fc</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">ec</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">step</span> <span class="o">=</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">step</span> <span class="o">=</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;$X$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.3</span><span class="p">,</span><span class="o">-</span><span class="mf">0.8</span><span class="p">,</span><span class="s1">&#39;$T(X)$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Projections_3_0.png" src="_images/Projections_3_0.png" />
</div>
</div>
</section>
<section id="example-2-nonorthogonal-projection-in-mathbb-r-2">
<h2>Example 2  Nonorthogonal Projection in <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span><a class="headerlink" href="#example-2-nonorthogonal-projection-in-mathbb-r-2" title="Permalink to this headline">¶</a></h2>
<p>Now let’s consider <span class="math notranslate nohighlight">\(T:\mathbb{R}^2 \to \mathbb{R}^2\)</span> defined by <span class="math notranslate nohighlight">\(T(X) = PX\)</span> where <span class="math notranslate nohighlight">\(P\)</span> is the following matrix.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\left[\begin{array}{rr} 3/2 &amp; -3/2 \\ 1/2 &amp; -1/2 \end{array}\right]
\end{equation}
\end{split}\]</div>
<p>To verify that <span class="math notranslate nohighlight">\(T\)</span> is indeed a projection, we need to check that <span class="math notranslate nohighlight">\(P^2X = PX\)</span> for every <span class="math notranslate nohighlight">\(X\)</span> in <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span>.  This will be true if <span class="math notranslate nohighlight">\(P^2=P\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="nd">@P</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1.5 -1.5]
 [ 0.5 -0.5]]
</pre></div>
</div>
</div>
</div>
<p>Now that we know <span class="math notranslate nohighlight">\(T\)</span> is a projection, let’s consider the effect of <span class="math notranslate nohighlight">\(T\)</span> a bit more carefully.  We observe that the second column is a multiple of the first.  This means that <span class="math notranslate nohighlight">\(\mathcal{C}(P)\)</span> is one-dimensional.  Since <span class="math notranslate nohighlight">\(P^2=P\)</span>, we
know that any vector <span class="math notranslate nohighlight">\(X\)</span> in the column space will be unchanged by when multiplied by <span class="math notranslate nohighlight">\(P\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
PX = \left[\begin{array}{rr} 3/2 &amp; -3/2 \\ 1/2 &amp; -1/2 \end{array}\right]
\left[\begin{array}{r} 3k \\ k \end{array}\right] =
\left[\begin{array}{r} 3k \\ k \end{array}\right] = X
\end{equation}
\end{split}\]</div>
<p>Next, let’s observe the effect of <span class="math notranslate nohighlight">\(T\)</span> on a vector <span class="math notranslate nohighlight">\(X\)</span> that is not in <span class="math notranslate nohighlight">\(\mathcal{C}(P)\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
PX = \left[\begin{array}{rr} 3/2 &amp; -3/2 \\ 1/2 &amp; -1/2 \end{array}\right]
\left[\begin{array}{r} 4 \\ 2 \end{array}\right] =
\left[\begin{array}{r} 3 \\ 1 \end{array}\right] 
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="nd">@X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[3.]
 [1.]]
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">fc</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">ec</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">fc</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">ec</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">step</span> <span class="o">=</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">step</span> <span class="o">=</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;$X$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;$PX$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mf">1.6</span><span class="p">,</span><span class="s1">&#39;$\mathcal</span><span class="si">{C}</span><span class="s1">(P)$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Projections_8_0.png" src="_images/Projections_8_0.png" />
</div>
</div>
<p>We see of course that <span class="math notranslate nohighlight">\(PX\)</span> is in <span class="math notranslate nohighlight">\(\mathcal{C}(P)\)</span>, but in contrast to the projections in earlier sections, this projections is not orthogonal.  If we decompose <span class="math notranslate nohighlight">\(X\)</span> into components <span class="math notranslate nohighlight">\(PX\)</span> and <span class="math notranslate nohighlight">\(X-PX\)</span>, we see that these components are not orthogonal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V</span> <span class="o">=</span> <span class="n">P</span><span class="nd">@X</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">X</span><span class="o">-</span><span class="n">V</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">E</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-8.0
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">fc</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">ec</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">fc</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">ec</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">fc</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">ec</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">step</span> <span class="o">=</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">step</span> <span class="o">=</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;$X$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;$PX$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;$X-PX$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mf">1.6</span><span class="p">,</span><span class="s1">&#39;$\mathcal</span><span class="si">{C}</span><span class="s1">(P)$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Projections_11_0.png" src="_images/Projections_11_0.png" />
</div>
</div>
<p>The transformation is projecting onto <span class="math notranslate nohighlight">\(\mathcal{C}(P)\)</span>, but <em>not in the orthogonal direction</em>.  To reveal the direction of the projection, we look at <span class="math notranslate nohighlight">\(\mathcal{N}(P)\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\mathcal{N}(P) = \textrm{Span of} \left\{ \left[ \begin{array}{r} 1 \\ 1 \end{array} \right]\right\}
\end{equation}
\end{split}\]</div>
<p>Any vector in <span class="math notranslate nohighlight">\(\mathcal{N}(P)\)</span> is projected to the zero vector.  The key point is that <span class="math notranslate nohighlight">\(PX-X\)</span> must be in <span class="math notranslate nohighlight">\(\mathcal{N}(P)\)</span> precisely because <span class="math notranslate nohighlight">\(P\)</span> represents a projection and <span class="math notranslate nohighlight">\(P^2=P\)</span>.</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
P(PX-X) = P^2X - PX = PX - PX = 0  
\end{equation}
\]</div>
<p>In general, projections take all vectors onto one subspace, in the direction of another subspace.</p>
</section>
<section id="orthogonal-projections">
<h2>Orthogonal Projections<a class="headerlink" href="#orthogonal-projections" title="Permalink to this headline">¶</a></h2>
<p>Having observed that projections can be carried out in an arbitrary direction, we now focus attention on how to define a matrix <span class="math notranslate nohighlight">\(P\)</span> that carries out <strong>orthogonal projection</strong> onto a subspace <span class="math notranslate nohighlight">\(\mathcal{V}\)</span> of <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>.  That is, for a vector <span class="math notranslate nohighlight">\(B\)</span> in <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>, we want the projection matrix <span class="math notranslate nohighlight">\(P\)</span> such that <span class="math notranslate nohighlight">\(\hat{B} = PB\)</span> is in <span class="math notranslate nohighlight">\(\mathcal{V}\)</span> and <span class="math notranslate nohighlight">\(E = B-\hat{B}\)</span> to be orthogonal to <span class="math notranslate nohighlight">\(\mathcal{V}\)</span>.  In fact, we have already seen the necessary calculations for these projections.</p>
<p>In the simplest example, <span class="math notranslate nohighlight">\(\mathcal{V}\)</span> is one-dimensional with basis <span class="math notranslate nohighlight">\(\{V\}\)</span>, with <span class="math notranslate nohighlight">\(V\)</span> a vector of unit length.  In our discussion of <a class="reference internal" href="Orthogonalization.html"><span class="doc std std-doc">orthogonalization</span></a> we worked out the following formula.</p>
<div class="math notranslate nohighlight">
\[ 
\begin{equation}
\hat{B} = \left(\frac{B\cdot V}{V\cdot V}\right){V}
\end{equation}
\]</div>
<p>Since <span class="math notranslate nohighlight">\(V\)</span> is a unit vector, we can use <span class="math notranslate nohighlight">\(V\cdot V=1\)</span>.  We can also manipulate this order of the factors since <span class="math notranslate nohighlight">\(B\cdot V = V\cdot B\)</span>, and the order that we multiply the scalar and vector does not affect the result.</p>
<div class="math notranslate nohighlight">
\[ 
\begin{equation}
\hat{B} = V \left(V\cdot B \right) 
\end{equation}
\]</div>
<p>In order to understand this as a matrix-vector multiplication, we can rewrite it using matrix multiplication for the dot products, and the associate property of matrix multiplication.</p>
<div class="math notranslate nohighlight">
\[ 
\begin{equation}
\hat{B} = V \left(V^TB \right) = (VV^T)B 
\end{equation}
\]</div>
<p>The result is that if <span class="math notranslate nohighlight">\(V\)</span> is a unit vector, the matrix <span class="math notranslate nohighlight">\(P = VV^T\)</span> orthogonally projects <span class="math notranslate nohighlight">\(B\)</span> onto <span class="math notranslate nohighlight">\(\mathcal{V}\)</span>.</p>
<p>In the most general case, <span class="math notranslate nohighlight">\(\mathcal{V}\)</span> is a <span class="math notranslate nohighlight">\(m\)</span>-dimensional subspace of <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> with basis <span class="math notranslate nohighlight">\(\{V_1, V_2,..., V_m\}\)</span>.  This scenario was treated in the previous section on least squares solutions.  If if <span class="math notranslate nohighlight">\(A\)</span> is a matrix with the <span class="math notranslate nohighlight">\(V_i\)</span> as columns, and <span class="math notranslate nohighlight">\(B\)</span> is a vector that is not in <span class="math notranslate nohighlight">\(\mathcal{C}(A)\)</span>, we found that we can solve the normal equations <span class="math notranslate nohighlight">\(A^TAX=A^TB\)</span> in order to find a vector <span class="math notranslate nohighlight">\(\hat{X}\)</span> such that <span class="math notranslate nohighlight">\(A\hat{X} = \hat{B}\)</span> and <span class="math notranslate nohighlight">\(\hat{B}\)</span> is the orthogonal projection of <span class="math notranslate nohighlight">\(B\)</span> onto <span class="math notranslate nohighlight">\(\mathcal{C}(A)\)</span>.  If we now want to focus on the projection of <span class="math notranslate nohighlight">\(B\)</span>, we can write <span class="math notranslate nohighlight">\(\hat{B} = PB\)</span> where <span class="math notranslate nohighlight">\(P = A(A^TA)^{-1}A^T\)</span> is the projection matrix.</p>
<p>In the case that we have an orthonormal basis, projection onto a subspace is quite a bit simpler.  If <span class="math notranslate nohighlight">\(\{U_1, U_2,..., U_m\}\)</span> is an orthonormal basis for an <span class="math notranslate nohighlight">\(m\)</span>-dimensional subspace <span class="math notranslate nohighlight">\(\mathcal{V}\)</span>, <span class="math notranslate nohighlight">\(\hat{B}\)</span> can be written in expressed in terms of the basis vectors, with coordinates computed using dot products.</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\hat{B} = (B\cdot U_1)U_1 + (B\cdot U_2)U_2 + ... + (B\cdot U_m)U_m
\end{equation}
\]</div>
<p>As we did in the 1-dimensional case, we can use the properties of dot products and matrix multiplications to rewrite this as <span class="math notranslate nohighlight">\(\hat{B} = PB\)</span> for some projectionmatrix <span class="math notranslate nohighlight">\(P\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\hat{B} &amp; = &amp; U_1(U_1\cdot B) + U_2(U_2\cdot B) + ... + U_m(U_m\cdot B) \\
&amp; = &amp; U_1(U_1^TB) + U_2(U_2^TB) + ... + U_m(U_m^TB) \\
&amp; = &amp; (U_1U_1^T)B + (U_2U_2^T)B + ... + (U_mU_m^T)B \\
&amp; = &amp; (U_1U_1^T + U_2U_2^T + ... + U_mU_m^T)B 
\end{eqnarray*}
\end{split}\]</div>
<p>Each of the matrices <span class="math notranslate nohighlight">\(U_i^TU_i\)</span> projects <span class="math notranslate nohighlight">\(B\)</span> onto the direction of <span class="math notranslate nohighlight">\(U_i\)</span>.  The sum of all of the individual projections gives us <span class="math notranslate nohighlight">\(\hat{B}\)</span>, and the sum of all the projection matrices gives us <span class="math notranslate nohighlight">\(P U_1U_1^T + U_2U_2^T + ... + U_mU_m^T\)</span>.</p>
<p>We can also realize that the formula <span class="math notranslate nohighlight">\(P = A(A^TA)^{-1}A^T\)</span> for the general case still applies.  Let’s take <span class="math notranslate nohighlight">\(Q\)</span> to be the matrix with <span class="math notranslate nohighlight">\(U_i\)</span> as columns.  Since <span class="math notranslate nohighlight">\(Q\)</span> is an orthogonal matrix, <span class="math notranslate nohighlight">\(Q^TQ= I\)</span>, and <span class="math notranslate nohighlight">\(P =  Q(Q^TQ)^{-1}Q^T = QQ^T\)</span>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "bvanderlei/jupyter-guide-to-linear-algebra",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="Least_Squares_Solutions.html" title="previous page">Least Squares Solutions</a>
    <a class='right-next' id="next-link" href="Applications_IP.html" title="next page">Applications of Inner Products</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Ben Vanderlei<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.30270b6e4c972e43c488.js"></script>


    
  </body>
</html>