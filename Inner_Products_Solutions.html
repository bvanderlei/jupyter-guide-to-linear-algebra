
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Inner Products &#8212; Jupyter Guide to Linear Algebra</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.c441f2ba0852f4cabcb80105e3a46ae6.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script src="_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Linear Transformations" href="Linear_Transformations_Solutions.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/reflection_logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Jupyter Guide to Linear Algebra</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Welcome to the Jupyter Guide to Linear Algebra
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="Jupyter_Introduction.html">
   Introduction to Jupyter
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="Python_Introduction.html">
     Introduction to Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Numpy_Introduction.html">
     Introduction to NumPy and Matplotlib
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="Linear_Systems.html">
   Linear Systems
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="Gaussian_Elimination.html">
     Gaussian Elimination
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Matrix_Algebra.html">
     Matrix Algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Solving_Systems.html">
     Solving Systems using Elimination
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Inverse_Matrices.html">
     Inverse Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="LU_Factorization.html">
     LU Factorization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Applications.html">
     Applications of Linear Systems and Matrix Algebra
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="Vector_Spaces.html">
   Vector Spaces
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="General_Linear_Systems.html">
     General Linear Systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Linear_Combinations.html">
     Linear Combinations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Linear_Independence.html">
     Linear Independence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Bases.html">
     Bases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Vector_Space_Examples.html">
     Vector Space Examples
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Applications_VS.html">
     Applications of Vector Spaces
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="Linear_Transformations.html">
   Linear Transformations
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="Matrix_Representations.html">
     Matrix Representations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Planar_Transformations.html">
     Transformations in a Plane
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Applications_LT.html">
     Applications of Linear Transformations
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="Inner_Products.html">
   Inner Products
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="Orthogonalization.html">
     Orthogonalization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="QR_Factorization.html">
     QR Factorization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Orthogonal_Subspaces.html">
     Orthogonal Subspaces
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Least_Squares_Solutions.html">
     Least Squares Solutions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Projections.html">
     Projections
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Applications_IP.html">
     Applications of Inner Products
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="Eigenvalues.html">
   Eigenvalues
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="Diagonalization.html">
     Diagonalization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Approximating_Eigenvalues.html">
     Approximating Eigenvalues
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Applications_EV.html">
     Applications of Eigenvalues and Eigenvectors
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="Solutions.html">
   Solutions
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="Introduction_Solutions.html">
     Introduction to Jupyter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Linear_Systems_Solutions.html">
     Linear Systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Vector_Spaces_Solutions.html">
     Vector Spaces
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Linear_Transformations_Solutions.html">
     Linear Transformations
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Inner Products
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Inner_Products_Solutions.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/bvanderlei/jupyter-guide-to-linear-algebra/main?urlpath=tree/Inner_Products_Solutions.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#orthogonalization">
   Orthogonalization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#qr-factorization">
   QR Factorization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#orthogonal-subspaces">
   Orthogonal Subspaces
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#least-squares-solutions">
   Least Squares Solutions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#projections">
   Projections
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="inner-products">
<h1>Inner Products<a class="headerlink" href="#inner-products" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">laguide</span> <span class="k">as</span> <span class="nn">lag</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.linalg</span> <span class="k">as</span> <span class="nn">sla</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">math</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 1:</strong> Create a Python function named <span class="math notranslate nohighlight">\(\texttt{Magnitude}\)</span> that accepts as an argument vector in the form of a NumPy array object with shape <span class="math notranslate nohighlight">\(n\times 1\)</span>, and returns the magnitude of that vector.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Magnitude</span><span class="p">(</span><span class="n">U</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; </span>
<span class="sd">    Magnitude(U)</span>
<span class="sd">    </span>
<span class="sd">    Magnitude computes the magnitude of U based on the Euclidean inner product</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    U : NumPy array object of dimension nx1</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    product: float</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Check shape of U</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Magnitude only accepts column vectors.&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    
    <span class="n">magnitude</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">U</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">magnitude</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 2:</strong> Use the <span class="math notranslate nohighlight">\(\texttt{random}\)</span> module of NumPy to generate random <span class="math notranslate nohighlight">\(4\times 1\)</span> vectors <span class="math notranslate nohighlight">\(U\)</span>, <span class="math notranslate nohighlight">\(V\)</span>, and <span class="math notranslate nohighlight">\(W\)</span>, and a random scalar <span class="math notranslate nohighlight">\(k\)</span>.  Verify the algebraic properties of the dot product listed above.  Try to make use of a conditional statement to check each statement.</p>
<p>We want to verify that the following equations hold for random <span class="math notranslate nohighlight">\(4 \times 1\)</span> vectors <span class="math notranslate nohighlight">\(U, V,\)</span> and <span class="math notranslate nohighlight">\(W\)</span> and scalar <span class="math notranslate nohighlight">\(k\)</span>.</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(U\cdot V = V\cdot U\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(U\cdot(V + W) = U\cdot V + U\cdot W\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\((kU)\cdot V = k(U\cdot V)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(U\cdot U \ge 0\)</span></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span> <span class="o">==</span> <span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">U</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The dot product is commutative. </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="o">+</span><span class="n">W</span><span class="p">)</span> <span class="o">==</span> <span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span> <span class="o">+</span> <span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">W</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The dot product distributes over vector addition. </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span> <span class="o">==</span> <span class="n">k</span><span class="o">*</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The dot product is associative with respect to scalar multiplication. </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">U</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The dot product of a vector with itself is greater than or equal to 0 </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 5]
 [ 8]
 [15]
 [10]] 

[[ 9]
 [16]
 [ 9]
 [10]] 

[[4]
 [2]
 [8]
 [0]] 

12 

The dot product is commutative. 

The dot product distributes over vector addition. 

The dot product is associative with respect to scalar multiplication. 

The dot product of a vector with itself is greater than or equal to 0 
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 3:</strong> Let <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> be the following vectors.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X = \left[ \begin{array}{r} 3 \\ -1 \\ 2  \end{array}\right] \hspace{1cm} 
Y = \left[ \begin{array}{r} 4 \\ 2 \\ 0  \end{array}\right] 
\end{equation}
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\((a)\)</span> Determine the angle between <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>.  (<em>You will need the <span class="math notranslate nohighlight">\(\texttt{acos}\)</span> function in Python’s <span class="math notranslate nohighlight">\(\texttt{math}\)</span> module.</em>)</p>
<p>We will use the following equation to determine the angle <span class="math notranslate nohighlight">\(\theta\)</span> between <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>, as well as the <span class="math notranslate nohighlight">\(\texttt{DotProduct}\)</span> and <span class="math notranslate nohighlight">\(\texttt{Magnitude}\)</span> functions.</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\cos{\theta} = \frac{X\cdot Y}{||X||||Y||}
\end{equation}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">((</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="n">lag</span><span class="o">.</span><span class="n">Magnitude</span><span class="p">(</span><span class="n">X</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">Magnitude</span><span class="p">(</span><span class="n">Y</span><span class="p">)))))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9302740141154721
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\((b)\)</span> Find a vector in <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span> that is orthogonal to the vector <span class="math notranslate nohighlight">\(X\)</span>.  Verify your answer with a computation.</p>
<p>Two vectors are <strong>orthogonal</strong> if their dot product is zero. The vector <span class="math notranslate nohighlight">\(W\)</span> defined below is an example of a vector that is orthogonal to <span class="math notranslate nohighlight">\(X\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
W = \left[ \begin{array}{r} 1 \\ 3 \\ 0  \end{array}\right] 
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">W</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\((c)\)</span> Construct a unit vector <span class="math notranslate nohighlight">\(Z\)</span> such that <span class="math notranslate nohighlight">\(Z\cdot Y = -||Y||\)</span>.  Verify your answer with a computation.</p>
<p><strong>Solution:</strong></p>
<p>Recall that if <span class="math notranslate nohighlight">\(\theta\)</span> is the angle between <span class="math notranslate nohighlight">\(Z\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>, then the following equation is an identity.</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{Z\cdot Y}{||Z||||Y||} = \cos\theta
\end{equation}
\]</div>
<p>Since we want <span class="math notranslate nohighlight">\(Z\)</span> to be a unit vector, <span class="math notranslate nohighlight">\(||Z|| = 1\)</span> and so we can rearrange to get</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
Z\cdot Y = ||Y||\cos{\theta} 
\end{equation}
\]</div>
<p>From here we can see that <span class="math notranslate nohighlight">\(Z \cdot Y = -||Y||\)</span> precisely when <span class="math notranslate nohighlight">\(\theta = \pi\)</span> or in other words, when <span class="math notranslate nohighlight">\(Z\)</span> is a unit vector pointing in the opposite direction of <span class="math notranslate nohighlight">\(Y\)</span>. To find such a <span class="math notranslate nohighlight">\(Z\)</span>, we can take any vector that points in the direction opposite to <span class="math notranslate nohighlight">\(Y\)</span> (<span class="math notranslate nohighlight">\(-Y\)</span> for example) and divide by its magnitude. Therefore</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
Z = \frac{-Y}{||-Y||} = \frac{1}{\sqrt{20}} \left[ \begin{array}{r} -4 \\ -2 \\ 0  \end{array}\right] = \left[ \begin{array}{r} \frac{-2\sqrt{5}}{5} \\ -\frac{\sqrt{5}}{5} \\ 0  \end{array}\right]
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">],[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">Y</span><span class="p">),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="o">-</span><span class="n">lag</span><span class="o">.</span><span class="n">Magnitude</span><span class="p">(</span><span class="n">Y</span><span class="p">),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">Magnitude</span><span class="p">(</span><span class="n">Z</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-4.47213595499958 

-4.47213595499958 

1.0
</pre></div>
</div>
</div>
</div>
<p><strong>Alternate Solution:</strong></p>
<p>First we calculate <span class="math notranslate nohighlight">\(-||Y|| = -\sqrt{4^2 + 2^2 + 0^2} = -2\sqrt{5}\)</span>. If we define the arbitrary vector <span class="math notranslate nohighlight">\(Z\)</span> as below, then we see that we need to find values for <span class="math notranslate nohighlight">\(z_1, z_2\)</span>, and <span class="math notranslate nohighlight">\(z_3\)</span> such that <span class="math notranslate nohighlight">\(||Z|| = \sqrt{(z_1)^2 + (z_2)^2 + (z_3)^2} = 1\)</span> and <span class="math notranslate nohighlight">\(Z \cdot Y = 4z_1 + 2z_2 + 0z_3 = -2\sqrt{5}\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
Z = \left[ \begin{array}{r} z_1 \\ z_2 \\ z_3  \end{array}\right] 
\end{equation}
\end{split}\]</div>
<p>Since <span class="math notranslate nohighlight">\(z_3\)</span> contributes nothing to the second sum above, lets set <span class="math notranslate nohighlight">\(z_3 = 0\)</span> for simplicities sake. This gives a system of two equations in two unknowns, namely</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
4z_1 + 2z_2 &amp; = &amp; -2\sqrt{5} \\
z_1^2 + z_2^2 &amp; = &amp; 1 \\
\end{eqnarray*}
\end{split}\]</div>
<p>Note that we can’t solve this system using elimination because the second equation is not linear.  Instead, if we solve for one of the variables in the first equation and substitute into the second, we will be able to use the quadratic formula to find a solution. Solving for <span class="math notranslate nohighlight">\(z_2\)</span> in the first equation, we get</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
z_2 &amp; = &amp; -\sqrt{5} - 2z_1 \\
\end{eqnarray*}
\end{split}\]</div>
<p>Next we substitute this equality in for <span class="math notranslate nohighlight">\(z_2\)</span> in our second equation, multiply out and move everything to the left.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
5z_1^2 + 4\sqrt{5}z_1 + 4 = 0 \\
\end{eqnarray*}
\end{split}\]</div>
<p>Using the quadratic formula reveals that the two roots of this equation are equal, namely <span class="math notranslate nohighlight">\(z_1 = -\frac{2}{5}\sqrt{5}\)</span>. If we substitute this into the equation above where we had solved for <span class="math notranslate nohighlight">\(z_2\)</span>, we see that <span class="math notranslate nohighlight">\(z_2 = -\frac{1}{5}\sqrt{5}\)</span> and thus the vector <span class="math notranslate nohighlight">\(Z\)</span> below is a solution to our problem.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
Z = \left[ \begin{array}{r} -\frac{2\sqrt{5}}{5} \\ -\frac{\sqrt{5}}{5} \\ 0  \end{array}\right] 
\end{equation}
\end{split}\]</div>
<p><strong>Exercise 4:</strong> Create a Python function named <span class="math notranslate nohighlight">\(\texttt{DifferenceMagnitude}\)</span> which takes two <span class="math notranslate nohighlight">\(n \times 1\)</span> vectors as arguments and returns the magnitude of their difference. Use this function to determine <span class="math notranslate nohighlight">\(|| X - Y||\)</span> where vectors <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> are given below.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X = \left[ \begin{array}{r} 3 \\ -1 \\ 2  \end{array}\right] \hspace{1cm} 
Y = \left[ \begin{array}{r} 4 \\ 2 \\ 0  \end{array}\right] 
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Building the function Difference Magnitude where X and y are two column vectors.</span>

<span class="k">def</span> <span class="nf">DifferenceMagnitude</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">):</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="n">Y</span>
    <span class="n">diffMag</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">Z</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">diffMag</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">DifferenceMagnitude</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.7416573867739413
</pre></div>
</div>
</div>
</div>
<p>We can see from the computations that <span class="math notranslate nohighlight">\(||X - Y|| = 3.714\)</span>.</p>
<p><strong>Exercise 5:</strong> Create a Python function which takes an <span class="math notranslate nohighlight">\(n \times 1\)</span> vector as its argument and returns the unit vector of the argument vector. Use the NumPy <span class="math notranslate nohighlight">\(\texttt{random}\)</span> module to generate a random <span class="math notranslate nohighlight">\(3 \times 1 \)</span> vector, and test this function on that vector.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Creating the UnitVector function</span>

<span class="k">def</span> <span class="nf">UnitVector</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="n">mag</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">X</span><span class="p">))</span>
    <span class="n">unitVect</span> <span class="o">=</span> <span class="n">X</span><span class="o">/</span><span class="n">mag</span>
    
    <span class="k">return</span> <span class="n">unitVect</span>

<span class="c1">## Building a random vector</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;X: </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The unit vector of X: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">UnitVector</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X: 
 [[4]
 [8]
 [3]] 

The unit vector of X: 
 [[0.42399915]
 [0.8479983 ]
 [0.31799936]] 
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 6:</strong> Find a vector <span class="math notranslate nohighlight">\(Y\)</span> in <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span> such that <span class="math notranslate nohighlight">\(X\cdot Y = ||Y - X||\)</span> where the vector <span class="math notranslate nohighlight">\(X\)</span> is given below. Is the vector <span class="math notranslate nohighlight">\(Y\)</span> unique ? Verify your answer through a computation.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X = \left[ \begin{array}{r} 1 \\ 1  \end{array}\right] 
\end{equation}
\end{split}\]</div>
<p><strong>Solution:</strong></p>
<p>Let us assume that the vector <span class="math notranslate nohighlight">\(Y\)</span> in <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span> is as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
Y = \left[ \begin{array}{r} a \\ b  \end{array}\right] 
\end{equation}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span> are some scalars.</p>
<p>So, $<span class="math notranslate nohighlight">\(
\begin{equation}
Y  - X= \left[ \begin{array}{r} a - 1 \\ b - 1  \end{array}\right] 
\end{equation}
\)</span>$</p>
<p><span class="math notranslate nohighlight">\(||Y - X||^2 = (a-1)^2 + (b-1)^2 \)</span></p>
<p><span class="math notranslate nohighlight">\(X\cdot Y = a + b\)</span></p>
<p>As <span class="math notranslate nohighlight">\(X\cdot Y = ||Y - X||\)</span> , <span class="math notranslate nohighlight">\((X\cdot Y)^2 = ||Y - X||^2 \)</span>.</p>
<p>So, <span class="math notranslate nohighlight">\( (a+b)^2 = (a - 1)^2 + (b-1)^2 \)</span></p>
<p><span class="math notranslate nohighlight">\( a^2 + b^2 + 2ab = a^2 + 1 - 2a + b^2 + 1 - 2b\)</span></p>
<p><span class="math notranslate nohighlight">\( 2ab = 2 - 2a - 2b\)</span></p>
<p><span class="math notranslate nohighlight">\(2a + 2b + 2ab = 2\)</span></p>
<p><span class="math notranslate nohighlight">\( a + b + ab = 1\)</span></p>
<p>The above equation is true for two possible set of real values of <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>. First case is when <span class="math notranslate nohighlight">\(a = 0\)</span> and <span class="math notranslate nohighlight">\(b = 1\)</span>, and second case is when <span class="math notranslate nohighlight">\(a = 1\)</span> and <span class="math notranslate nohighlight">\(b = 0\)</span>.</p>
<p>Therefore, we get two possible vectors <span class="math notranslate nohighlight">\(Y\)</span> which are as follows:</p>
<p>So, $<span class="math notranslate nohighlight">\(
\begin{equation}
Y = \left[ \begin{array}{r} 1 \\ 0  \end{array}\right] \hspace{1cm} or \hspace{1cm}
Y = \left[ \begin{array}{r} 0 \\ 1  \end{array}\right]
\end{equation}
\)</span>$</p>
<p>This implies that the vector <span class="math notranslate nohighlight">\(Y\)</span> is not unique. We can verify our results in the code cell below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Building vectors X and Y:</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">Y_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">Y_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">dotProd1</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y_1</span><span class="p">)</span>
<span class="n">dotProd2</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y_2</span><span class="p">)</span>

<span class="n">diffMag1</span> <span class="o">=</span> <span class="n">DifferenceMagnitude</span><span class="p">(</span><span class="n">Y_1</span><span class="p">,</span> <span class="n">X</span> <span class="p">)</span>
<span class="n">diffMag2</span> <span class="o">=</span> <span class="n">DifferenceMagnitude</span><span class="p">(</span><span class="n">Y_2</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dot product of X and Y_1 is: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dotProd1</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The magnitude of difference of Y_1 and X is: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">diffMag1</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dot product of X and Y_2 is: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dotProd2</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The magnitude of difference of Y_2 and X is: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">diffMag2</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dot product of X and Y_1 is: 
 1.0 

The magnitude of difference of Y_1 and X is: 
 1.0 

Dot product of X and Y_2 is: 
 1.0 

The magnitude of difference of Y_2 and X is: 
 1.0 
</pre></div>
</div>
</div>
</div>
<p>The computations done in the above code cell demonstrate that the vector <span class="math notranslate nohighlight">\(Y\)</span> is not unique.</p>
<p><strong>Exercise 7:</strong> Create a Python function named <span class="math notranslate nohighlight">\(\texttt{Angle}\)</span> which takes two vectors as arguments and returns <span class="math notranslate nohighlight">\(\cos{\theta}\)</span> where <span class="math notranslate nohighlight">\({\theta}\)</span> is the angle between the two vectors. Use this function to show that vectors <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(W\)</span> are orthogonal.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
U = \left[ \begin{array}{r} 1 \\ -1 \\ 2  \end{array}\right] \hspace{1cm} 
W = \left[ \begin{array}{r} 2 \\ 0 \\ -1  \end{array}\right] 
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Building the function Angle</span>

<span class="k">def</span> <span class="nf">Angle</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">):</span>
    <span class="n">dotProd</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    <span class="n">magX</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span><span class="p">))</span>
    <span class="n">magY</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">Y</span><span class="p">))</span>
    <span class="n">cos_theta</span> <span class="o">=</span> <span class="n">dotProd</span><span class="o">/</span><span class="p">(</span><span class="n">magX</span><span class="o">*</span><span class="n">magY</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">cos_theta</span>

<span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">Angle</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">W</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
<p>We can see that <span class="math notranslate nohighlight">\(\cos{\theta} = 0\)</span> for vectors <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(W\)</span> which means that <span class="math notranslate nohighlight">\(\theta = 90^{\circ}\)</span>. This implies that <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(W\)</span> are orthogonal vectors.</p>
<p><strong>Exercise 8:</strong> Given that <span class="math notranslate nohighlight">\(||X+Y|| = 3\)</span>, <span class="math notranslate nohighlight">\(X\cdot Y = 2\)</span>, find <span class="math notranslate nohighlight">\(||X-Y||\)</span>.</p>
<p><strong>Solution:</strong></p>
<p>We know that <span class="math notranslate nohighlight">\(||X + Y||^2 = (X+Y)\cdot (X+Y)\)</span></p>
<p><span class="math notranslate nohighlight">\(||X + Y||^2 = ||X||^2 + ||Y||^2 + 2X\cdot Y\)</span></p>
<p>Given <span class="math notranslate nohighlight">\(||X + Y||\)</span> and <span class="math notranslate nohighlight">\(X\cdot Y\)</span>,we can find <span class="math notranslate nohighlight">\(||X||^2  + ||Y||^2\)</span> as follows:</p>
<p><span class="math notranslate nohighlight">\( (3)^2 = ||X||^2 + ||Y||^2 + 2(2)\)</span></p>
<p><span class="math notranslate nohighlight">\(||X||^2 + ||Y||^2 = 5\)</span></p>
<p>Now, <span class="math notranslate nohighlight">\(||X - Y||^2 = (X-Y)\cdot (X-Y)\)</span></p>
<p><span class="math notranslate nohighlight">\(||X - Y||^2 = ||X||^2 + ||Y||^2 - 2X\cdot Y\)</span></p>
<p>We can now substitute the values for <span class="math notranslate nohighlight">\(||X||^2 + ||Y||^2\)</span> and <span class="math notranslate nohighlight">\(X\cdot Y\)</span> to get:</p>
<p><span class="math notranslate nohighlight">\(||X - Y||^2 = 5 - 2(2)\)</span></p>
<p><span class="math notranslate nohighlight">\(||X - Y||^2 = 1\)</span></p>
<p>Therefore, <span class="math notranslate nohighlight">\(||X - Y|| = 1\)</span></p>
<div class="section" id="orthogonalization">
<h2>Orthogonalization<a class="headerlink" href="#orthogonalization" title="Permalink to this headline">¶</a></h2>
<p><strong>Exercise 1:</strong>  Explain why a set of nonzero mutually orthogonal vectors must be linearly independent.</p>
<p><strong>Solution:</strong></p>
<p>Suppose we have some set of mutually orthogonal vectors <span class="math notranslate nohighlight">\(\{U_1,U_2, \cdots ,U_n\}\)</span>. To say that this set is linearly independent is equivalent to saying that if <span class="math notranslate nohighlight">\(a_1U_1 + a_2U_2 + \cdots a_nU_n = 0\)</span> for some scalars <span class="math notranslate nohighlight">\(a_1, a_2, \cdots , a_n\)</span>, then <span class="math notranslate nohighlight">\(a_1 = a_2 = \cdots a_n = 0\)</span>. To see that this must be the case, take the dot product of each side of the equation with <span class="math notranslate nohighlight">\(U_i\)</span> for each <span class="math notranslate nohighlight">\(1 \leq i \leq n\)</span>. Since the vectors are mutually orthogonal, <span class="math notranslate nohighlight">\(U_i \cdot U_j = 0\)</span> when <span class="math notranslate nohighlight">\(i \neq j\)</span> and thus we get <span class="math notranslate nohighlight">\(a_i(U_i \cdot U_i) = 0\)</span>. Therefore <span class="math notranslate nohighlight">\(a_i = 0\)</span> for all <span class="math notranslate nohighlight">\(1 \leq i \leq n\)</span> and so our set of vectors is linearly independent.</p>
<p><strong>Exercise 2:</strong>  Derive the formula for the projection of <span class="math notranslate nohighlight">\(B\)</span> onto <span class="math notranslate nohighlight">\(V\)</span> in another way that doesn’t involve <span class="math notranslate nohighlight">\(\cos{\theta}\)</span>.  Let <span class="math notranslate nohighlight">\(\hat{B} = kV\)</span>, where <span class="math notranslate nohighlight">\(k\)</span> is an unknown scalar.  Now use <span class="math notranslate nohighlight">\(\hat{B}\cdot E\)</span> to determine <span class="math notranslate nohighlight">\(k\)</span> directly.</p>
<p><strong>Exercise 3:</strong> The set <span class="math notranslate nohighlight">\(\beta = \{U_1, U_2, U_3\}\)</span> is an orthonormal basis for <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
U_1 = \frac{1}{\sqrt{6}}\left[ \begin{array}{r} 2 \\ 1 \\ 1 \end{array}\right] \hspace{0.7cm} 
U_2 = \frac{1}{\sqrt{2}}\left[ \begin{array}{r} 0 \\ -1 \\ 1 \end{array}\right] \hspace{0.7cm}
U_3 = \frac{1}{\sqrt{3}}\left[ \begin{array}{r} -1 \\ 1 \\ 1 \end{array}\right] \hspace{0.7cm}
\end{equation}
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\((a)\)</span> Define <span class="math notranslate nohighlight">\(Q\)</span> as the matrix with columns <span class="math notranslate nohighlight">\(U_1\)</span>, <span class="math notranslate nohighlight">\(U_2\)</span>, and <span class="math notranslate nohighlight">\(U_3\)</span>.  Verify that <span class="math notranslate nohighlight">\(Q^TQ=I\)</span>.</p>
<p><strong>Solution:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">s3</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">s6</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="o">/</span><span class="n">s6</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">s3</span><span class="p">],[</span><span class="mi">1</span><span class="o">/</span><span class="n">s6</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">s2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="n">s3</span><span class="p">],[</span><span class="mi">1</span><span class="o">/</span><span class="n">s6</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="n">s2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="n">s3</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@Q</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1.00000000e+00 -2.45142679e-17  1.10971636e-17]
 [-2.45142679e-17  1.00000000e+00  1.77961928e-17]
 [ 1.10971636e-17  1.77961928e-17  1.00000000e+00]]
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\((b)\)</span> Let <span class="math notranslate nohighlight">\(X\)</span> be the following vector, and compute <span class="math notranslate nohighlight">\([X]_{\beta}\)</span> by solving <span class="math notranslate nohighlight">\(Q[X]
_{\beta}= X\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X = \left[ \begin{array}{r} 3 \\ 1 \\ -4 \end{array}\right] 
\end{equation}
\end{split}\]</div>
<p><strong>Solution:</strong></p>
<p>Since <span class="math notranslate nohighlight">\(Q^TQ = I\)</span>, multiplying both sides of the equation above by <span class="math notranslate nohighlight">\(Q^T\)</span> on the left gives us <span class="math notranslate nohighlight">\([X]_{\beta} = Q^TX\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">s3</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">s6</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="o">/</span><span class="n">s6</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">s3</span><span class="p">],[</span><span class="mi">1</span><span class="o">/</span><span class="n">s6</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">s2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="n">s3</span><span class="p">],[</span><span class="mi">1</span><span class="o">/</span><span class="n">s6</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="n">s2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="n">s3</span><span class="p">]])</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">4</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1.22474487]
 [-3.53553391]
 [-3.46410162]]
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 4:</strong> Find a vector that is orthogonal to the column space of the matrix <span class="math notranslate nohighlight">\(A\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
A = \left[ \begin{array}{rr} 1 &amp; 2\\ 2 &amp; 0 \\ 3 &amp; 1\end{array}\right] 
\end{equation}
\end{split}\]</div>
<p><strong>Solution:</strong></p>
<p>Since there is a pivot in each column of the matrix <span class="math notranslate nohighlight">\(A\)</span>, the basis for the column space of <span class="math notranslate nohighlight">\(A\)</span> consists of the two column vectors.</p>
<p>Let</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X_1 = \left[ \begin{array}{r} 1 \\ 2 \\ 3 \end{array}\right] \hspace{1cm}
X_2 = \left[ \begin{array}{r} 2 \\ 0 \\ 1 \end{array}\right] 
\end{equation}
\end{split}\]</div>
<p>Then the basis for the column space of <span class="math notranslate nohighlight">\(A\)</span> is <span class="math notranslate nohighlight">\(\{X_1,X_2\}\)</span>. Let us consider a vector <span class="math notranslate nohighlight">\(Y\)</span> which is orthogonal to vectors <span class="math notranslate nohighlight">\(X_1\)</span>, <span class="math notranslate nohighlight">\(X_2\)</span>. This means that <span class="math notranslate nohighlight">\(X_1\cdot Y = 0\)</span> and <span class="math notranslate nohighlight">\(X_2\cdot Y=0\)</span>.</p>
<p>Let</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
Y = \left[ \begin{array}{r} a \\ b \\ c \end{array}\right] \hspace{1cm} 
\end{equation}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(c\)</span> are some scalars.</p>
<p>The conditions <span class="math notranslate nohighlight">\(X_1\cdot Y = 0\)</span> and <span class="math notranslate nohighlight">\(X_2\cdot Y=0\)</span> gives a system of equations to solve:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
a + 2b + 3c &amp; = &amp; 0\\
2a\,\,\,\,\,\,\,\,\,\,\,\,\, + c &amp; = &amp; 0\\ 
\end{eqnarray*}
\end{split}\]</div>
<p>Since <span class="math notranslate nohighlight">\(c\)</span> is a free variable we let <span class="math notranslate nohighlight">\(c = t\)</span>, where <span class="math notranslate nohighlight">\(t\)</span> is some real number.  From the above two equations, we can then find the values of <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> in terms of <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p><span class="math notranslate nohighlight">\(a = -t/2\)</span>  and <span class="math notranslate nohighlight">\(b = -5t/4\)</span>.</p>
<p>Therefore, the vector <span class="math notranslate nohighlight">\(Y\)</span> is as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
Y = t\left[ \begin{array}{r} -1/2 \\ -5/4 \\ 1 \end{array}\right] \hspace{1cm} 
\end{equation}
\end{split}\]</div>
<p>So, one particular vector orthogonal to the column space of <span class="math notranslate nohighlight">\(A\)</span> is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\left[ \begin{array}{r} -1/2 \\ -5/4 \\ 1 \end{array}\right] \hspace{1cm} 
\end{equation}
\end{split}\]</div>
<p><strong>Exercise 5:</strong> Let <span class="math notranslate nohighlight">\(\mathcal{U}\)</span> be the subspace spanned by <span class="math notranslate nohighlight">\(\{V_1,V_2\}\)</span>. Apply the Gram-Schimdt orthogonalization on the basis <span class="math notranslate nohighlight">\(\{V_1,V_2\}\)</span> to produce an orthonormal basis <span class="math notranslate nohighlight">\(\{U_1,U_2\}\)</span> for <span class="math notranslate nohighlight">\(\mathcal{U}\)</span>.  Verify that <span class="math notranslate nohighlight">\(\{U_1,U_2\}\)</span> is an orthonormal basis with a computation.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
V_1 = \left[ \begin{array}{r} 1 \\ 1 \\ 2 \end{array}\right] \hspace{1cm}
V_2 = \left[ \begin{array}{r} 2 \\ 1 \\ 3 \end{array}\right] 
\end{equation}
\end{split}\]</div>
<p><strong>Solution:</strong></p>
<p>We first produce an orthogonal basis, <span class="math notranslate nohighlight">\(\{W_1,W_2\}\)</span>, for <span class="math notranslate nohighlight">\(\mathcal{U}\)</span>, then scale the orthogonal vectors to produce an orthonormal basis <span class="math notranslate nohighlight">\(\{U_1,U_2\}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Generating the orthogonal vectors w_1 and w_2:</span>

<span class="n">v_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">v_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">]])</span>

<span class="n">w_1</span> <span class="o">=</span> <span class="n">v_1</span> 
<span class="n">w_2</span> <span class="o">=</span> <span class="n">v_2</span> <span class="o">-</span> <span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">w_1</span><span class="p">,</span> <span class="n">v_2</span><span class="p">)</span><span class="o">/</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">w_1</span><span class="p">,</span> <span class="n">w_1</span><span class="p">))</span><span class="o">*</span><span class="n">w_1</span>

<span class="c1"># Generating the orthonormal vectors by scaling the orthogonal vectors:</span>

<span class="n">u_1</span> <span class="o">=</span> <span class="n">w_1</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">w_1</span><span class="p">,</span><span class="n">w_1</span><span class="p">))</span>
<span class="n">u_2</span> <span class="o">=</span> <span class="n">w_2</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">w_2</span><span class="p">,</span><span class="n">w_2</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;u_1: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">u_1</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;u_2: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">u_2</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Verifying that u_1 and u_2 are orthonormal.</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The dot product of u_1 and u_2 is: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">u_1</span><span class="p">,</span><span class="n">u_2</span><span class="p">),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The magnitude of u_1 is: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">u_1</span><span class="p">,</span><span class="n">u_1</span><span class="p">)),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The magnitude of u_2 is: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">u_2</span><span class="p">,</span><span class="n">u_2</span><span class="p">)),</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>u_1: 
 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.40824829]
 [0.40824829]
 [0.81649658]] 

u_2: 
 [[ 0.70710678]
 [-0.70710678]
 [ 0.        ]] 

The dot product of u_1 and u_2 is: 
 0.0 

The magnitude of u_1 is: 
 1.0 

The magnitude of u_2 is: 
 1.0 
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 6:</strong> Let <span class="math notranslate nohighlight">\(\mathcal{U}\)</span> be the subspace spanned by <span class="math notranslate nohighlight">\(\{X_1,X_2\}\)</span>. Apply the Gram-Schimdt orthogonalization on the basis <span class="math notranslate nohighlight">\(\{X_1,X_2\}\)</span> to produce an orthonormal basis <span class="math notranslate nohighlight">\(\{U_1,U_2\}\)</span> for <span class="math notranslate nohighlight">\(\mathcal{U}\)</span>.  Verify that <span class="math notranslate nohighlight">\(\{U_1,U_2\}\)</span> is an orthonormal basis with a computation.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X_1 = \left[ \begin{array}{r} 1 \\ 0 \\ 2 \\ 2 \end{array}\right] \hspace{0.7cm} 
X_2 = \left[ \begin{array}{r} -2 \\ 1 \\ 0 \\ -1 \end{array}\right]
\end{equation}
\end{split}\]</div>
<p>We first produce an orthogonal basis, <span class="math notranslate nohighlight">\(\{W_1,W_2\}\)</span>, for <span class="math notranslate nohighlight">\(\mathcal{U}\)</span>, then scale the orthogonal vectors to produce an orthonormal basis <span class="math notranslate nohighlight">\(\{U_1,U_2\}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Generating the orthogonal vectors w_1 and w_2:</span>

<span class="n">x_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">x_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">w_1</span> <span class="o">=</span> <span class="n">x_1</span> 
<span class="n">w_2</span> <span class="o">=</span> <span class="n">x_2</span> <span class="o">-</span> <span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">w_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">)</span><span class="o">/</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">w_1</span><span class="p">,</span> <span class="n">w_1</span><span class="p">))</span><span class="o">*</span><span class="n">w_1</span>

<span class="c1"># Generating the orthonormal vectors by scaling the orthogonal vectors:</span>

<span class="n">u_1</span> <span class="o">=</span> <span class="n">w_1</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">w_1</span><span class="p">,</span><span class="n">w_1</span><span class="p">))</span>
<span class="n">u_2</span> <span class="o">=</span> <span class="n">w_2</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">w_2</span><span class="p">,</span><span class="n">w_2</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;u_1: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">u_1</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;u_2: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">u_2</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Verifying that u_1 and u_2 are orthonormal.</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The dot product of u_1 and u_2 is: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">u_1</span><span class="p">,</span><span class="n">u_2</span><span class="p">),</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The magnitude of u_1 is: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">u_1</span><span class="p">,</span><span class="n">u_1</span><span class="p">)),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The magnitude of u_2 is: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">u_2</span><span class="p">,</span><span class="n">u_2</span><span class="p">)),</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>u_1: 
 [[0.33333333]
 [0.        ]
 [0.66666667]
 [0.66666667]] 

u_2: 
 [[-0.7570333 ]
 [ 0.48666426]
 [ 0.43259046]
 [-0.05407381]] 

The dot product of u_1 and u_2 is: 
 -0.0 

The magnitude of u_1 is: 
 1.0 

The magnitude of u_2 is: 
 1.0 
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 7:</strong> Let <span class="math notranslate nohighlight">\(V\)</span> be a vector in <span class="math notranslate nohighlight">\(\mathbb{R}^4\)</span>. Explain why the set of vectors orthogonal to <span class="math notranslate nohighlight">\(V\)</span> is a subspace of <span class="math notranslate nohighlight">\(\mathbb{R}^4\)</span>.</p>
<p><strong>Solution:</strong></p>
<p>Let <span class="math notranslate nohighlight">\(U\)</span> be the set of all vectors which are orthogonal to the vector <span class="math notranslate nohighlight">\(v\)</span>. Let us consider two vectors <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> in <span class="math notranslate nohighlight">\(U\)</span>.</p>
<p>The vectors <span class="math notranslate nohighlight">\(v\)</span>, <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
v = \left[ \begin{array}{r} v_1 \\ v_2 \\ v_3 \\ v_4 \end{array}\right] \hspace{1cm}
x = \left[ \begin{array}{r}  x_1 \\ x_2 \\ x_3 \\ x_4 \end{array}\right] \hspace{1cm}
y = \left[ \begin{array}{r}  y_1 \\ y_2 \\ y_3 \\ y_4 \end{array}\right] \hspace{1cm}
\end{equation}
\end{split}\]</div>
<p>where all the enteries are some scalars.</p>
<p>Since vectors <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are in <span class="math notranslate nohighlight">\(U\)</span>, the vectors <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> need to be orthogonal to the vector <span class="math notranslate nohighlight">\(v\)</span>. This basically means that <span class="math notranslate nohighlight">\(x\cdot v = 0\)</span> and <span class="math notranslate nohighlight">\(y\cdot v = 0\)</span>.</p>
<p>So, <span class="math notranslate nohighlight">\(x_1v_1 + x_2v_2 +x_3v_3 + x_4v_4 = 0\)</span> ,</p>
<p><span class="math notranslate nohighlight">\(y_1v_1 + y_2v_2 +y_3v_3 + y_4v_4 = 0\)</span>.</p>
<p>On adding the two equations, we get</p>
<p><span class="math notranslate nohighlight">\((x_1 + y_1)v_1 + (x_2 + y_2)v_2 + (x_3 + y_3)v_3 + (x_4 + y_4)v_4 = 0\)</span></p>
<p>The <em>LHS</em> is actually the dot product of vector <span class="math notranslate nohighlight">\((x+y)\)</span> with <span class="math notranslate nohighlight">\(v\)</span> and since the dot product of vector <span class="math notranslate nohighlight">\((x + y)\)</span> with <span class="math notranslate nohighlight">\(v\)</span> equals 0, <span class="math notranslate nohighlight">\((x+y)\)</span> is also in <span class="math notranslate nohighlight">\(U\)</span>.</p>
<p>On multiplying the equation <span class="math notranslate nohighlight">\(x_1v_1 + x_2v_2 +x_3v_3 + x_4v_4 = 0\)</span> by <span class="math notranslate nohighlight">\(k\)</span> on both sides, we get:</p>
<p><span class="math notranslate nohighlight">\(kx_1v_1 + kx_2v_2 + kx_3v_3 + kx_4v_4 = k(0) = 0\)</span></p>
<p>The <em>LHS</em> of the above equation is basically the dot product of <span class="math notranslate nohighlight">\(kx\)</span> and <span class="math notranslate nohighlight">\(v\)</span> which also equals zero. Therefore, <span class="math notranslate nohighlight">\(kx\)</span> is orthogonal to <span class="math notranslate nohighlight">\(v\)</span> and hence, <span class="math notranslate nohighlight">\(kx\)</span> is also present in <span class="math notranslate nohighlight">\(U\)</span>.</p>
<p>This imples that for any two vectors <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> in <span class="math notranslate nohighlight">\(U\)</span>, vectors <span class="math notranslate nohighlight">\((x+y)\)</span> and <span class="math notranslate nohighlight">\(kx\)</span> are also present in <span class="math notranslate nohighlight">\(U\)</span>. This satisfies the condition for a subspace and therefore, <span class="math notranslate nohighlight">\(U\)</span> is a subspace of <span class="math notranslate nohighlight">\(\mathbb{R}^4\)</span>.</p>
<p><strong>Exercise 8:</strong> Given vectors <span class="math notranslate nohighlight">\(V\)</span> and <span class="math notranslate nohighlight">\(W\)</span>, find vectors <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> such that <span class="math notranslate nohighlight">\(X\)</span> is the projection of <span class="math notranslate nohighlight">\(V\)</span> in the direction of <span class="math notranslate nohighlight">\(W\)</span> and <span class="math notranslate nohighlight">\(V = X + Y\)</span>. Verify your answer.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
V = \left[ \begin{array}{r} 
9\\ 5 \\ 0 \end{array}\right] \hspace{1cm}
W = \left[ \begin{array}{r} 3 \\ 0 \\ 3 \end{array}\right] 
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Building vectors V and W:</span>

<span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">9</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">5</span><span class="p">]])</span>

<span class="n">X</span> <span class="o">=</span> <span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span><span class="o">/</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">W</span><span class="p">))</span><span class="o">*</span><span class="n">W</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">V</span> <span class="o">-</span> <span class="n">X</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;X: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Y: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Verifying if X and Y are orthogonal to each other.</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The dot product of X and Y is: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="mi">8</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X: 
 [[2.38235294]
 [0.        ]
 [3.97058824]] 

Y: 
 [[ 6.61764706]
 [ 5.        ]
 [-3.97058824]] 

The dot product of X and Y is: 
 0.0 
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 9:</strong> Let <span class="math notranslate nohighlight">\(U\)</span> be a vector space spanned by the columns of <span class="math notranslate nohighlight">\(A\)</span>. Find an orthonormal basis for <span class="math notranslate nohighlight">\(U\)</span> to generate an orthogonal matrix <span class="math notranslate nohighlight">\(Q\)</span>. Verify that <span class="math notranslate nohighlight">\(Q^TQ = I\)</span> where <span class="math notranslate nohighlight">\(I\)</span> is the identity matrix.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
A = \left[ \begin{array}{r} 1 &amp; 2 &amp; -1\\ 0 &amp; 2 &amp; 1 \\  1 &amp; 1 &amp; 2 \end{array}\right]  
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Building the matrix A</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">A_red</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">FullRowReduction</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A_reduced: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">A_red</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A_reduced: 
 [[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]] 
</pre></div>
</div>
</div>
</div>
<p>We can see from the above code cell that there is a pivot in each column of <span class="math notranslate nohighlight">\(A\)</span>. Therefore, the column vectors of <span class="math notranslate nohighlight">\(A\)</span> are linearly independent. As <span class="math notranslate nohighlight">\(U\)</span> is spanned by the columns of <span class="math notranslate nohighlight">\(A\)</span> and the columns of <span class="math notranslate nohighlight">\(A\)</span> are linearly independent, we can say that the columns of <span class="math notranslate nohighlight">\(A\)</span> are a basis for the vector space <span class="math notranslate nohighlight">\(U\)</span>.</p>
<p>Let</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
x_1 = \left[ \begin{array}{r} 1\\ 0 \\ 1 \end{array}\right] \hspace{1cm}
x_2 = \left[ \begin{array}{r} 2 \\ 2 \\ 1 \end{array}\right] \hspace{1cm}
x_3 = \left[ \begin{array}{r} -1 \\ 1 \\ 2 \end{array}\right] \hspace{1cm}
\end{equation}
\end{split}\]</div>
<p>Then, <span class="math notranslate nohighlight">\(U = \texttt{Span}\{x_1,x_2,x_3\}\)</span>. Now, we can perform <strong>Gram-Schimdt</strong> orthogonalization on the bases vectors <span class="math notranslate nohighlight">\(x_1\)</span>, <span class="math notranslate nohighlight">\(x_2\)</span>, and <span class="math notranslate nohighlight">\(x_3\)</span> to get the orthonormal vectors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## building the vectors X_1, X_2, X_3:</span>

<span class="n">X_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">X_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">X_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>

<span class="c1">## Let the orthogonal vectors be W_1, W_2, W_3:</span>

<span class="n">W_1</span> <span class="o">=</span> <span class="n">X_1</span>
<span class="n">W_2</span> <span class="o">=</span> <span class="n">X_2</span> <span class="o">-</span> <span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">X_2</span><span class="p">,</span> <span class="n">W_1</span><span class="p">)</span><span class="o">/</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">W_1</span><span class="p">,</span> <span class="n">W_1</span><span class="p">))</span><span class="o">*</span><span class="n">W_1</span>
<span class="n">W_3</span> <span class="o">=</span> <span class="n">X_3</span> <span class="o">-</span> <span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">X_3</span><span class="p">,</span> <span class="n">W_1</span><span class="p">)</span><span class="o">/</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">W_1</span><span class="p">,</span> <span class="n">W_1</span><span class="p">))</span><span class="o">*</span><span class="n">W_1</span> <span class="o">-</span> <span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">X_3</span><span class="p">,</span> <span class="n">W_2</span><span class="p">)</span><span class="o">/</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">W_2</span><span class="p">,</span> <span class="n">W_2</span><span class="p">))</span><span class="o">*</span><span class="n">W_2</span>

<span class="c1">## Let the orthonormal vectors be U_1, U_2, U_3</span>

<span class="n">U_1</span> <span class="o">=</span> <span class="n">W_1</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">W_1</span><span class="p">,</span> <span class="n">W_1</span><span class="p">))</span>
<span class="n">U_2</span> <span class="o">=</span> <span class="n">W_2</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">W_2</span><span class="p">,</span> <span class="n">W_2</span><span class="p">))</span>
<span class="n">U_3</span> <span class="o">=</span> <span class="n">W_3</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">W_3</span><span class="p">,</span> <span class="n">W_3</span><span class="p">))</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;U_1: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">U_1</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;U_2: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">U_2</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;U_3: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">U_3</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1">## Stacking the orthonormal vectors in a matrix to get the orthogonal matrix Q:</span>

<span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">U_1</span><span class="p">,</span><span class="n">U_2</span><span class="p">,</span> <span class="n">U_3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Q: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>


<span class="c1">## Verification:</span>
<span class="n">Q_T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Q_T@Q: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Q_T</span><span class="nd">@Q</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;I: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>U_1: 
 [[0.70710678]
 [0.        ]
 [0.70710678]] 

U_2: 
 [[ 0.23570226]
 [ 0.94280904]
 [-0.23570226]] 

U_3: 
 [[-0.66666667]
 [ 0.33333333]
 [ 0.66666667]] 

Q: 
 [[ 0.70710678  0.23570226 -0.66666667]
 [ 0.          0.94280904  0.33333333]
 [ 0.70710678 -0.23570226  0.66666667]] 

Q_T@Q: 
 [[ 1. -0. -0.]
 [-0.  1. -0.]
 [-0. -0.  1.]] 

I: 
 [[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]] 
</pre></div>
</div>
</div>
</div>
<p>In the above code cell, we used <strong>Gram-Schimdt</strong> Orthogonalization to generate a set of orthonormal bases i.e <span class="math notranslate nohighlight">\(\{U_1,U_2,U_3\}\)</span>. Then, we can generate a matrix <span class="math notranslate nohighlight">\(Q\)</span> which contains the orthonormal vectors as its columns. We have also verified that <span class="math notranslate nohighlight">\(Q^TQ = I\)</span>.</p>
<p><strong>Exercise 10:</strong> Consider two vectors <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>. Given that <span class="math notranslate nohighlight">\(Z\)</span> is the projection of <span class="math notranslate nohighlight">\(X\)</span> in the direction of <span class="math notranslate nohighlight">\(Y\)</span> and <span class="math notranslate nohighlight">\(X \cdot Y = 6\)</span>, find <span class="math notranslate nohighlight">\(Y\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X = \left[ \begin{array}{r} 2\\ 1 \\ 1 \end{array}\right] \hspace{1cm}
Z = \left[ \begin{array}{r} 1 \\ 1 \\ 0 \end{array}\right] 
\end{equation}
\end{split}\]</div>
<p><strong>Solution:</strong></p>
<p>We have been given that the vector <span class="math notranslate nohighlight">\(Z\)</span> is in the direction of vector <span class="math notranslate nohighlight">\(Y\)</span>. Therefore, the angle between the vector <span class="math notranslate nohighlight">\(X\)</span> and the vector <span class="math notranslate nohighlight">\(Z\)</span> is same as the angle between the vectors <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>.</p>
<p>The angle between the vectors <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Z\)</span> is as follows:</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\cos{\theta} = \frac{X\cdot Z}{||X||||Z||} = \frac{3}{\sqrt{2} \sqrt{6}} = \frac{\sqrt{3}}{2}
\end{equation}
\]</div>
<p>Hence, <span class="math notranslate nohighlight">\(\theta = 30^{\circ}\)</span> and this is also the angle between vectors <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>.</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\cos{30^{\circ}} = \frac{X\cdot Y}{||X||||Y||} = \frac{6}{\sqrt{6}||Y||} = \frac{\sqrt{3}}{2}
\end{equation}
\]</div>
<p>From here, we can get <span class="math notranslate nohighlight">\(||Y||\)</span> as follows:</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
||Y|| = \frac{2\sqrt{6}}{\sqrt{3}} = 2\sqrt{2}
\end{equation}
\]</div>
<p>Now, let us find  unit vector in the direction of <span class="math notranslate nohighlight">\(Y\)</span>. Unit vector in the direction of <span class="math notranslate nohighlight">\(Z\)</span> is also the unit vector in the direction of <span class="math notranslate nohighlight">\(Y\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\hat{Y} =  \frac{Z}{||Z||}\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\hat{Y} = \left[ \begin{array}{r} \frac{1}{\sqrt{2}}\\ \frac{1}{\sqrt{2}} \\ 0 \end{array}\right] 
\end{equation}
\end{split}\]</div>
<p>Therefore, the vector <span class="math notranslate nohighlight">\(Y\)</span> is as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
Y = \hat{Y}||Y|| = 2\sqrt{2}\left[ \begin{array}{r} \frac{1}{\sqrt{2}}\\ \frac{1}{\sqrt{2}} \\ 0 \end{array}\right] =  
\left[ \begin{array}{r} 2 \\ 2 \\ 0 \end{array}\right] 
\end{equation}
\end{split}\]</div>
</div>
<div class="section" id="qr-factorization">
<h2>QR Factorization<a class="headerlink" href="#qr-factorization" title="Permalink to this headline">¶</a></h2>
<p><strong>Exercise 1:</strong></p>
<p>(<span class="math notranslate nohighlight">\(a\)</span>) Carry out the Gram-Schmidt algorithm on the following set of vectors to produce an orthonormal set <span class="math notranslate nohighlight">\(\{U_1, U_2, U_3\}\)</span>.  <strong>Do not</strong> use the <span class="math notranslate nohighlight">\(\texttt{QRFactorization}\)</span> function from this section or the SciPy <span class="math notranslate nohighlight">\(\texttt{qr}\)</span> function.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
V_1 = \left[ \begin{array}{r} 0 \\ 2 \\ 0 \\ 1 \end{array}\right] \hspace{0.7cm} 
V_2 = \left[ \begin{array}{r} 1 \\ 1 \\ 1 \\ 1 \end{array}\right] \hspace{0.7cm}
V_3 = \left[ \begin{array}{r} 2 \\ 2 \\ 0 \\ 1 \end{array}\right] \hspace{0.7cm}
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here.</span>
</pre></div>
</div>
</div>
</div>
<p>(<span class="math notranslate nohighlight">\(b\)</span>) Check your results by verifying that <span class="math notranslate nohighlight">\(\{U_1, U_2, U_3\}\)</span> is an orthonormal set and that the span of <span class="math notranslate nohighlight">\(\{U_1, U_2, U_3\}\)</span> equals the span of <span class="math notranslate nohighlight">\(\{V_1, V_2, V_3\}\)</span>.  (Reread <a class="reference internal" href="Linear_Combinations.html"><span class="doc std std-doc">Linear_Combinations</span></a> if you are unsure how to verify the two spans are equal.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here.</span>
</pre></div>
</div>
</div>
</div>
<p>(<span class="math notranslate nohighlight">\(c\)</span>) Check your results against those obtained using the <span class="math notranslate nohighlight">\(\texttt{QRFactorization}\)</span> function from this section or the <span class="math notranslate nohighlight">\(\texttt{qr}\)</span> function from SciPy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here.</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 2:</strong></p>
<p>(<span class="math notranslate nohighlight">\(a\)</span>) Predict what will happen if we attempt to find the QR factorization of matrix with <em>linearly dependent</em> columns.</p>
<p>(<span class="math notranslate nohighlight">\(b\)</span>) Try to compute the QR factorization on the following matrix with <em>linearly dependent</em> columns.  Try both the <span class="math notranslate nohighlight">\(\texttt{QRFactorization}\)</span> function from this section or the <span class="math notranslate nohighlight">\(\texttt{qr}\)</span> function from SciPy.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
B = \left[ \begin{array}{rrr} 
1 &amp; 3 &amp; -1  \\ 
0 &amp; -1 &amp; 1  \\ 
2 &amp; 2 &amp; 2  \\
1 &amp; 1 &amp; 1  \\
1 &amp; 0 &amp; 2  \\
\end{array}\right]
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here.</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 3:</strong> If possible, find the <span class="math notranslate nohighlight">\(QR\)</span> factorization of the matrix <span class="math notranslate nohighlight">\(A\)</span>. Try to find the matrices <span class="math notranslate nohighlight">\(Q\)</span> and <span class="math notranslate nohighlight">\(R\)</span> without using the <span class="math notranslate nohighlight">\(\texttt{QRFactorization}\)</span> function from this section, then check your result by verifying that <span class="math notranslate nohighlight">\(QR=A\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
A = \left[ \begin{array}{rrr} 
1 &amp; 3 &amp; 0 &amp; 2  \\ 
0 &amp; 1 &amp; 2 &amp; 1 \\ 
2 &amp; 1 &amp; 2 &amp; 1 \\
1 &amp; 0 &amp; 1 &amp; 3 \\
\end{array}\right]
\end{equation}
\end{split}\]</div>
<p><strong>Solution:</strong></p>
<p>We can find the <span class="math notranslate nohighlight">\(QR\)</span> factorization of <span class="math notranslate nohighlight">\(A\)</span> if the columns of <span class="math notranslate nohighlight">\(A\)</span> are linearly independent.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Building the matrix A</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="n">A_reduced</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">FullRowReduction</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A_reduced:  </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">A_reduced</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A_reduced:  
 [[1. 0. 0. 0.]
 [0. 1. 0. 0.]
 [0. 0. 1. 0.]
 [0. 0. 0. 1.]] 
</pre></div>
</div>
</div>
</div>
<p>We see that there is a pivot in every column of the matrix <span class="math notranslate nohighlight">\(A\)</span>, which means the columns are linearly independent and we can find the <span class="math notranslate nohighlight">\(QR\)</span> factorization.</p>
<p>In order to find the orthogonal matrix <span class="math notranslate nohighlight">\(Q\)</span>, we perform the <strong>Gram-Schimdt</strong> orthogonalization on the columns of <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>So, let</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
V_1 = \left[ \begin{array}{r} 1 \\ 0 \\ 2 \\ 1 \end{array}\right] \hspace{0.7cm} 
V_2 = \left[ \begin{array}{r} 3 \\ 1 \\ 1 \\ 0 \end{array}\right] \hspace{0.7cm}
V_3 = \left[ \begin{array}{r} 0 \\ 2 \\ 2 \\ 1 \end{array}\right] \hspace{0.7cm}
V_4 = \left[ \begin{array}{r} 2 \\ 1 \\ 1 \\ 3 \end{array}\right] \hspace{0.7cm}
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Building vectors V_1, V_2, V_3, V_4:</span>

<span class="n">V_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">V_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">V_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">V_4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">]])</span>


<span class="c1">## Building the orthogonal vectors W_1, W_2,W_3, W_4:</span>

<span class="n">W_1</span> <span class="o">=</span> <span class="n">V_1</span>
<span class="n">W_2</span> <span class="o">=</span> <span class="n">V_2</span> <span class="o">-</span> <span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">V_2</span><span class="p">,</span> <span class="n">W_1</span><span class="p">)</span><span class="o">/</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">W_1</span><span class="p">,</span><span class="n">W_1</span><span class="p">))</span><span class="o">*</span><span class="n">W_1</span>
<span class="n">W_3</span> <span class="o">=</span> <span class="n">V_3</span> <span class="o">-</span> <span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">V_3</span><span class="p">,</span> <span class="n">W_1</span><span class="p">)</span><span class="o">/</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">W_1</span><span class="p">,</span><span class="n">W_1</span><span class="p">))</span><span class="o">*</span><span class="n">W_1</span> <span class="o">-</span> <span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">V_3</span><span class="p">,</span> <span class="n">W_2</span><span class="p">)</span><span class="o">/</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">W_2</span><span class="p">,</span> <span class="n">W_2</span><span class="p">))</span><span class="o">*</span><span class="n">W_2</span>
<span class="n">W_4</span> <span class="o">=</span> <span class="n">V_4</span> <span class="o">-</span> <span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">V_4</span><span class="p">,</span> <span class="n">W_1</span><span class="p">)</span><span class="o">/</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">W_1</span><span class="p">,</span><span class="n">W_1</span><span class="p">))</span><span class="o">*</span><span class="n">W_1</span> <span class="o">-</span> <span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">V_4</span><span class="p">,</span> <span class="n">W_2</span><span class="p">)</span><span class="o">/</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">W_2</span><span class="p">,</span> <span class="n">W_2</span><span class="p">))</span><span class="o">*</span><span class="n">W_2</span> <span class="o">-</span> <span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">V_4</span><span class="p">,</span> <span class="n">W_3</span><span class="p">)</span><span class="o">/</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">W_3</span><span class="p">,</span> <span class="n">W_3</span><span class="p">))</span><span class="o">*</span><span class="n">W_3</span>


<span class="c1">## Building the orthonormal vectors U_1, U_2, U_3, U_4:</span>

<span class="n">U_1</span> <span class="o">=</span> <span class="n">W_1</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">W_1</span><span class="p">,</span><span class="n">W_1</span><span class="p">))</span>
<span class="n">U_2</span> <span class="o">=</span> <span class="n">W_2</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">W_2</span><span class="p">,</span><span class="n">W_2</span><span class="p">))</span>
<span class="n">U_3</span> <span class="o">=</span> <span class="n">W_3</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">W_3</span><span class="p">,</span><span class="n">W_3</span><span class="p">))</span>
<span class="n">U_4</span> <span class="o">=</span> <span class="n">W_4</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">W_4</span><span class="p">,</span><span class="n">W_4</span><span class="p">))</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;U_1: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">U_1</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;U_2: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">U_2</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;U_3: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">U_3</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;U_4: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">U_4</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">U_1</span><span class="p">,</span><span class="n">U_2</span><span class="p">,</span><span class="n">U_3</span><span class="p">,</span><span class="n">U_4</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Q: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>U_1: 
 [[0.40824829]
 [0.        ]
 [0.81649658]
 [0.40824829]] 

U_2: 
 [[ 0.82884973]
 [ 0.38254603]
 [-0.25503069]
 [-0.31878836]] 

U_3: 
 [[-0.35516115]
 [ 0.92119924]
 [ 0.14428422]
 [ 0.06659272]] 

U_4: 
 [[ 0.14213381]
 [ 0.07106691]
 [-0.49746834]
 [ 0.85280287]] 

Q: 
 [[ 0.40824829  0.82884973 -0.35516115  0.14213381]
 [ 0.          0.38254603  0.92119924  0.07106691]
 [ 0.81649658 -0.25503069  0.14428422 -0.49746834]
 [ 0.40824829 -0.31878836  0.06659272  0.85280287]] 
</pre></div>
</div>
</div>
</div>
<p>The vectors that result from the orthogonalization form the matrix <span class="math notranslate nohighlight">\(Q\)</span>.  Now, we compute <span class="math notranslate nohighlight">\(R\)</span> and verify that <span class="math notranslate nohighlight">\(QR=A\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q_trans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Q_trans</span><span class="nd">@A</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;R: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1">## Verifying that A = QR</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;QR: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Q</span><span class="nd">@R</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>R: 
 [[ 2.44949  2.04124  2.04124  2.85774]
 [-0.       2.61406 -0.06376  0.82885]
 [-0.      -0.       2.19756  0.55494]
 [ 0.       0.       0.       2.41627]] 

A: 
 [[1 3 0 2]
 [0 1 2 1]
 [2 1 2 1]
 [1 0 1 3]] 

QR: 
 [[ 1.  3. -0.  2.]
 [ 0.  1.  2.  1.]
 [ 2.  1.  2.  1.]
 [ 1.  0.  1.  3.]] 
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 4:</strong> Are all matrices which have <span class="math notranslate nohighlight">\(QR\)</span> factorization invertible? Explain.</p>
<p><strong>Solution:</strong></p>
<p>No, not all matrices which have <span class="math notranslate nohighlight">\(QR\)</span> factorization are invertible. Only square matrices can be invertible, but non-square matrices may have <span class="math notranslate nohighlight">\(QR\)</span> factorizations.</p>
<p><strong>Exercise 5:</strong> Use the <span class="math notranslate nohighlight">\(QR\)</span> factorization of <span class="math notranslate nohighlight">\(A\)</span> to solve the given linear system <span class="math notranslate nohighlight">\(AX = B\)</span>, and verify the solution.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
AX = \left[ \begin{array}{rrrr} 
1 &amp; 2 &amp; 3  \\ 
0 &amp; 3 &amp; 2  \\ 
1 &amp; 1 &amp; 4  \\
\end{array}\right]
\quad\quad
X = 
\left[ \begin{array}{r} 1 \\ 1 \\ 1 \\  \end{array} \right]
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Building the matrices A and B:</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">]])</span>

<span class="n">Q</span><span class="p">,</span><span class="n">R</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">QRFactorization</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="n">C</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@B</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">BackSubstitution</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;X: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>


<span class="c1">## Verifying that AX = B</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AX: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">A</span><span class="nd">@X</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;B: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X: 
 [[-3.]
 [-1.]
 [ 2.]] 

AX: 
 [[1.]
 [1.]
 [4.]] 

B: 
 [[1]
 [1]
 [4]] 
</pre></div>
</div>
</div>
</div>
<p>The computation verifies <span class="math notranslate nohighlight">\(AX = B\)</span>.</p>
<p><strong>Exercise 6:</strong> <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> are two <span class="math notranslate nohighlight">\(n \times n\)</span> matrices.</p>
<p>(<span class="math notranslate nohighlight">\(a\)</span>) Given that the product <span class="math notranslate nohighlight">\(BA\)</span> has <span class="math notranslate nohighlight">\(QR\)</span> factorization, prove that the matrix <span class="math notranslate nohighlight">\(A\)</span> also has a <span class="math notranslate nohighlight">\(QR\)</span> factorization.</p>
<p>(<span class="math notranslate nohighlight">\(b\)</span>) Can you think of matrices <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> such that <span class="math notranslate nohighlight">\(B\)</span> has linearly dependent columns  but the product <span class="math notranslate nohighlight">\(BA\)</span> has <span class="math notranslate nohighlight">\(QR\)</span> factorization? Explain.</p>
<p><strong>Solution:</strong></p>
<p><span class="math notranslate nohighlight">\((a)\)</span> It has been given that the product <span class="math notranslate nohighlight">\(BA\)</span> has a <span class="math notranslate nohighlight">\(QR\)</span> factorization, this means that the columns of the matrix <span class="math notranslate nohighlight">\(BA\)</span> are linearly independent. If the columns of an <span class="math notranslate nohighlight">\(n \times n\)</span> matrix <span class="math notranslate nohighlight">\(P\)</span> are linearly independent, it means that the solution to the system <span class="math notranslate nohighlight">\(PX = R\)</span> will be unique.</p>
<p>Therefore, if the columns of matrix <span class="math notranslate nohighlight">\(BA\)</span> are linearly independent, this implies that the homogenous system <span class="math notranslate nohighlight">\(BAX = 0\)</span> must have a trivial solution i.e <span class="math notranslate nohighlight">\(X = 0\)</span>.</p>
<p>Now, let us consider the homogenous system <span class="math notranslate nohighlight">\(AX = 0\)</span>. If we multiply both the sides of this equation by <span class="math notranslate nohighlight">\(B\)</span>, it gives:</p>
<p><span class="math notranslate nohighlight">\(AX = 0\)</span></p>
<p><span class="math notranslate nohighlight">\( B(AX) = B(0)\)</span></p>
<p><span class="math notranslate nohighlight">\( (BA)X = 0\)</span></p>
<p>This means <span class="math notranslate nohighlight">\(X = 0\)</span> since <span class="math notranslate nohighlight">\(BA(X) = 0\)</span>  has a trivial solution only.</p>
<p>So, we started off by saying that <span class="math notranslate nohighlight">\(AX = 0\)</span> and we got <span class="math notranslate nohighlight">\(X = 0\)</span>. This means that the system <span class="math notranslate nohighlight">\(AX = 0\)</span> has only the trivial solution. This means that the columns of <span class="math notranslate nohighlight">\(A\)</span> are also linearly independent. Therefore, <span class="math notranslate nohighlight">\(A\)</span> also has a <span class="math notranslate nohighlight">\(QR\)</span> factorization.</p>
<p><span class="math notranslate nohighlight">\((b)\)</span> Let us consider a <span class="math notranslate nohighlight">\( 2 \times 3\)</span> matrix <span class="math notranslate nohighlight">\(B\)</span> and its transpose.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
B = \left[ \begin{array}{rr} 1 &amp;&amp; 2 &amp;&amp; 1 \\ 2 &amp;&amp; 3 &amp;&amp; 0   \end{array}\right] \hspace{0.7cm} 
\quad\quad
B^T = \left[ \begin{array}{rr} 1 &amp;&amp; 2 \\ 2 &amp;&amp; 3 \\ 1 &amp;&amp; 0  \end{array}\right] \hspace{0.7cm} 
\end{equation}
\end{split}\]</div>
<p>Now, let us consider the product <span class="math notranslate nohighlight">\(BB^T\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Building the matrices B and B_transpose</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">B_transpose</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The product of B and B_transpose is:  </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">B</span><span class="nd">@B_transpose</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">U</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">FullRowReduction</span><span class="p">(</span><span class="n">B</span><span class="nd">@B_transpose</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;U: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The product of B and B_transpose is:  
 [[ 6  8]
 [ 8 13]] 

U: 
 [[1. 0.]
 [0. 1.]] 
</pre></div>
</div>
</div>
</div>
<p>We see that though the matrix <span class="math notranslate nohighlight">\(B\)</span> has linearly dependent columns, the matrix <span class="math notranslate nohighlight">\(BB^T\)</span> has linearly independent columns (<span class="math notranslate nohighlight">\(BB^T\)</span> has a pivot in each column).  Hence, we can say that the matrix <span class="math notranslate nohighlight">\(BB^T\)</span> has a <span class="math notranslate nohighlight">\(QR\)</span> factorization.</p>
<p>Therefore, if we consider that the matrix <span class="math notranslate nohighlight">\(A = B^T\)</span>, then <span class="math notranslate nohighlight">\(BA\)</span> has a <span class="math notranslate nohighlight">\(QR\)</span> factorization even though <span class="math notranslate nohighlight">\(B\)</span> does not have a <span class="math notranslate nohighlight">\(QR\)</span> factorization.</p>
<p><strong>Exercise 7:</strong> If <span class="math notranslate nohighlight">\(A\)</span> is an <span class="math notranslate nohighlight">\(n \times n\)</span> invertible matrix, explain why <span class="math notranslate nohighlight">\(A^TA\)</span> is also invertible.</p>
<p><strong>Solution:</strong></p>
<p>If we assume that the matrix <span class="math notranslate nohighlight">\(A\)</span> is invertible, then it has a pivot in each column.  This means that the columns of <span class="math notranslate nohighlight">\(A\)</span> are linearly independent and that <span class="math notranslate nohighlight">\(A\)</span> has a <span class="math notranslate nohighlight">\(QR\)</span> factorization.</p>
<p>So, <span class="math notranslate nohighlight">\( A^TA = (QR)^T(QR)\)</span> = <span class="math notranslate nohighlight">\( R^TQ^TQR = R^T(Q^TQ)R = R^TR \)</span>.</p>
<p>Since <span class="math notranslate nohighlight">\(R\)</span> is an upper-triangular matrix with non-zero enteries on the diagonal we can reduce it to the identity matrix <span class="math notranslate nohighlight">\(I\)</span> by performing row operations.  This means that <span class="math notranslate nohighlight">\(R\)</span> is invertible. The matrix <span class="math notranslate nohighlight">\(R^T\)</span> is lower triangular with non-zero entries on the diagonal and is invertible for the same reason.  Since <span class="math notranslate nohighlight">\(A^TA\)</span> is the product of two invertible matrices, it must also be invertible.  (<em>See exercises in <a class="reference internal" href="Inverse_Matrices.html"><span class="doc std std-doc">Inverse Matrices</span></a>.)</em></p>
</div>
<div class="section" id="orthogonal-subspaces">
<h2>Orthogonal Subspaces<a class="headerlink" href="#orthogonal-subspaces" title="Permalink to this headline">¶</a></h2>
<p><strong>Exercise 1:</strong> Let <span class="math notranslate nohighlight">\(B\)</span> be the following <span class="math notranslate nohighlight">\(4\times 3\)</span> matrix.  Find bases for <span class="math notranslate nohighlight">\(\mathcal{C}(B^T)\)</span> and <span class="math notranslate nohighlight">\(\mathcal{N}(B)\)</span>, the row space and null space of <span class="math notranslate nohighlight">\(B\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
B = \left[ \begin{array}{rrr} 4 &amp; -3 &amp; -2  \\ 2 &amp; 0 &amp; 2 \\ 0 &amp; 1 &amp; 2 \\ 1 &amp; 1 &amp; 3 \end{array}\right]
\end{equation}
\end{split}\]</div>
<p><strong>Solution:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="n">B_transpose</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">B_transpose_reduced</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">FullRowReduction</span><span class="p">(</span><span class="n">B_transpose</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">B_transpose</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">B_transpose_reduced</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 4  2  0  1]
 [-3  0  1  1]
 [-2  2  2  3]] 

[[ 1.          0.         -0.33333333 -0.33333333]
 [ 0.          1.          0.66666667  1.16666667]
 [ 0.          0.          0.          0.        ]]
</pre></div>
</div>
</div>
</div>
<p>There are pivots in the first, and second column of <span class="math notranslate nohighlight">\(B^T\)</span> so the following set of vectors is a basis for <span class="math notranslate nohighlight">\(\mathcal{C}(B^T)\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\left\{ \left[\begin{array}{r} 4 \\ -3 \\ -2 \end{array}\right]\hspace{0.2cm}, \hspace{0.2cm} \left[\begin{array}{r} 2 \\ 0 \\ 2 \end{array}\right] \right\}
\end{eqnarray*}
\end{split}\]</div>
<p>Recall that to find a basis for <span class="math notranslate nohighlight">\(\mathcal{N}(B)\)</span> we first find the solutions to <span class="math notranslate nohighlight">\(BX = 0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B_reduced</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">FullRowReduction</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">B_reduced</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 4 -3 -2]
 [ 2  0  2]
 [ 0  1  2]
 [ 1  1  3]] 

[[1. 0. 1.]
 [0. 1. 2.]
 [0. 0. 0.]
 [0. 0. 0.]]
</pre></div>
</div>
</div>
</div>
<p>There exist pivots in the first two columns only, so <span class="math notranslate nohighlight">\(x_3\)</span> is a free variable. If we parametrize <span class="math notranslate nohighlight">\(x_3\)</span> as <span class="math notranslate nohighlight">\(x_3 = r\)</span>, then <span class="math notranslate nohighlight">\(x_1 = -r\)</span> and <span class="math notranslate nohighlight">\(x_2 = -2r\)</span>. Then we can write the components of a general solution vector <span class="math notranslate nohighlight">\(X\)</span> in terms of <span class="math notranslate nohighlight">\(r\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X = \left[ \begin{array}{r} x_1 \\ x_ 2 \\ x_ 3 \end{array}\right] =  
r\left[ \begin{array}{r} -1 \\ -2 \\  1 \end{array}\right]
\end{equation}
\end{split}\]</div>
<p>Therefore the following vector forms a basis for <span class="math notranslate nohighlight">\(\mathcal{N}(B)\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\left\{ \left[\begin{array}{r} -1 \\ -2 \\ 1 \end{array}\right] \right\}
\end{eqnarray*}
\end{split}\]</div>
<p><strong>Exercise 2:</strong> Using the matrix <span class="math notranslate nohighlight">\(B\)</span> and the bases from the previous exercise, determine vectors <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(E\)</span> such that <span class="math notranslate nohighlight">\(P\)</span> is in <span class="math notranslate nohighlight">\(\mathcal{C}(B^T)\)</span>, <span class="math notranslate nohighlight">\(E\)</span> is in <span class="math notranslate nohighlight">\(\mathcal{N}(B)\)</span>, and <span class="math notranslate nohighlight">\(P+E = X\)</span>, where <span class="math notranslate nohighlight">\(X\)</span> is the following vector.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X = \left[ \begin{array}{r} 8 \\ 1 \\ -2\end{array}\right]\hspace{0.7cm}  
\end{equation}
\end{split}\]</div>
<p><strong>Solution:</strong></p>
<p>If we find a linear combination of the three vectors that sum to <span class="math notranslate nohighlight">\(X\)</span> then we will be able to find <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(E\)</span> easily. This is equivalent to solving the following system.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\left[\begin{array}{rrr} 4 &amp; 2 &amp; -1 \\ -3 &amp; 0 &amp; -2 \\ -2 &amp; 2 &amp; 1  \end{array}\right] \left[\begin{array}{r} y_1 \\ y_2 \\ y_3 \end{array}\right]  = \left[\begin{array}{r} 8 \\ 1 \\ -2 \end{array}\right]  
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">8</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">Inverse</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="nd">@X</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1.]
 [ 1.]
 [-2.]]
</pre></div>
</div>
</div>
</div>
<p>Therefore if we take <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(E\)</span> as defined below, then <span class="math notranslate nohighlight">\(P\)</span> is in <span class="math notranslate nohighlight">\(\mathcal{C}(B^T)\)</span>, <span class="math notranslate nohighlight">\(E\)</span> is in <span class="math notranslate nohighlight">\(\mathcal{N}(B)\)</span>, and <span class="math notranslate nohighlight">\(P+E = X\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
P = \left[ \begin{array}{r} 4 \\ -3 \\ -2 \end{array}\right] + \left[ \begin{array}{r} 2 \\ 0 \\ 2 \end{array}\right] =  
\left[ \begin{array}{r} 6 \\ -3 \\  0 \end{array}\right] \hspace{1cm} E = -2\left[ \begin{array}{r} -1 \\ -2 \\ 1 \end{array}\right] = \left[ \begin{array}{r} 2 \\ 4 \\ -2 \end{array}\right]
\end{equation}
\end{split}\]</div>
<p><strong>Exercise 3:</strong> Let <span class="math notranslate nohighlight">\(A\)</span> be the matrix in <strong>Example 3</strong>.  Find bases for <span class="math notranslate nohighlight">\(\mathcal{C}(A)\)</span> and <span class="math notranslate nohighlight">\(\mathcal{N}(A^T)\)</span>, the column space and left null space of <span class="math notranslate nohighlight">\(A\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">A_reduced</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">FullRowReduction</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A_reduced</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[2 1 2 0]
 [3 0 1 1]
 [1 1 1 0]] 

[[ 1.   0.   0.   0.5]
 [ 0.   1.   0.   0. ]
 [ 0.   0.   1.  -0.5]]
</pre></div>
</div>
</div>
</div>
<p>There are pivots in the first three columns of <span class="math notranslate nohighlight">\(A\)</span> so the following set of vectors is a basis for <span class="math notranslate nohighlight">\(\mathcal{C}(A)\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\left\{ \left[\begin{array}{r} 2 \\ 3 \\ 1 \end{array}\right]\hspace{0.2cm}, \hspace{0.2cm} \left[\begin{array}{r} 1 \\ 0 \\ 1 \end{array}\right]\hspace{0.2cm}, \hspace{0.2cm} \left[\begin{array}{r} 2 \\ 1 \\ 1 \end{array}\right] \right\}
\end{eqnarray*}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_transpose</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">A_transpose_reduced</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">FullRowReduction</span><span class="p">(</span><span class="n">A_transpose</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A_transpose</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A_transpose_reduced</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[2 3 1]
 [1 0 1]
 [2 1 1]
 [0 1 0]] 

[[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]
 [0. 0. 0.]]
</pre></div>
</div>
</div>
</div>
<p>Since every column has a pivot, the columns of <span class="math notranslate nohighlight">\(A^T\)</span> are linearly independent and therefore the only solution to <span class="math notranslate nohighlight">\(A^TX = 0\)</span> is <span class="math notranslate nohighlight">\(X = 0\)</span>. Thus the left null space of <span class="math notranslate nohighlight">\(A\)</span> contains only the zero vector.</p>
<p><strong>Exercise 4:</strong> Let <span class="math notranslate nohighlight">\(\mathcal{U}\)</span> be the subspace of <span class="math notranslate nohighlight">\(\mathbb{R}^4\)</span> spanned by <span class="math notranslate nohighlight">\(\{U_1,U_2\}\)</span>. Find a basis for the orthogonal complement <span class="math notranslate nohighlight">\(U^{\perp}\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
U_1 = \left[ \begin{array}{r} 1 \\ 0 \\ 2 \\ 2 \end{array}\right] \hspace{0.7cm} 
U_2 = \left[ \begin{array}{r} -2 \\ 1 \\ 0 \\ -1 \end{array}\right]
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here.</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 5:</strong> Let <span class="math notranslate nohighlight">\(\mathcal{W}\)</span> be a subspace of <span class="math notranslate nohighlight">\(\mathbb{R}^5\)</span> with basis <span class="math notranslate nohighlight">\(\{W_1, W_2, W_3\}\)</span>.  Find a basis for the orthogonal complement <span class="math notranslate nohighlight">\(\mathcal{W}^{\perp}\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
W_1 = \left[ \begin{array}{r} 1 \\ 1 \\ 0 \\ 1 \\ 1 \end{array}\right]\hspace{0.7cm}  
W_2 = \left[ \begin{array}{r} 3 \\ 2 \\ 0 \\ 1 \\ 1 \end{array}\right]\hspace{0.7cm} 
W_3 = \left[ \begin{array}{r} 0 \\ 1 \\ 1 \\ 1 \\ 2 \end{array}\right] 
\end{equation}
\end{split}\]</div>
<p>If we take the vectors <span class="math notranslate nohighlight">\(W_1, W_2,\)</span> and <span class="math notranslate nohighlight">\(W_3\)</span> as the columns of the following matrix <span class="math notranslate nohighlight">\(W\)</span>, then the column space of <span class="math notranslate nohighlight">\(W\)</span> is precisely <span class="math notranslate nohighlight">\(\mathcal{W}\)</span>. But we know that the orthogonal complement of the column space of matrix is equivalent to the left null space of that matrix, so we look for a basis of the left null space of <span class="math notranslate nohighlight">\(W\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
W = \left[ \begin{array}{rrr} 1 &amp; 3 &amp; 0  \\ 1 &amp; 2 &amp; 1 \\ 0 &amp; 0 &amp; 1 \\ 1 &amp; 1 &amp; 1 \\ 1 &amp; 1 &amp; 2 \end{array}\right]
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">W_transpose</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">W_transpose_reduced</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">FullRowReduction</span><span class="p">(</span><span class="n">W_transpose</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_transpose</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_transpose_reduced</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1 1 0 1 1]
 [3 2 0 1 1]
 [0 1 1 1 2]] 

[[ 1.  0.  0. -1. -1.]
 [ 0.  1.  0.  2.  2.]
 [ 0.  0.  1. -1.  0.]]
</pre></div>
</div>
</div>
</div>
<p>There exists pivots in the first three columns only, so <span class="math notranslate nohighlight">\(x_4\)</span> and <span class="math notranslate nohighlight">\(x_5\)</span> are free variables. If we parametrize <span class="math notranslate nohighlight">\(x_4 = r\)</span>  and <span class="math notranslate nohighlight">\(x_5 = s\)</span> then <span class="math notranslate nohighlight">\(x_1 = r + s\)</span> and <span class="math notranslate nohighlight">\(x_2 = -2r -2s\)</span> and <span class="math notranslate nohighlight">\(x_3 = r\)</span>. Then we can write the components of a general solution vector <span class="math notranslate nohighlight">\(X\)</span> to the equation <span class="math notranslate nohighlight">\(W^TX = 0\)</span> in terms of these parameters.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X = \left[ \begin{array}{r} x_1 \\ x_ 2 \\ x_ 3 \\ x_4 \\ x_5 \end{array}\right] =  
r\left[ \begin{array}{r} 1 \\ -2 \\  1 \\ 1 \\ 0\end{array}\right] + s\left[ \begin{array}{r} 1 \\ -2 \\  0 \\ 0 \\ 1\end{array}\right]
\end{equation}
\end{split}\]</div>
<p>Therefore the following set of vectors forms a basis for <span class="math notranslate nohighlight">\(\mathcal{N}(W^T)\)</span> or <span class="math notranslate nohighlight">\(\mathcal{W}^{\perp}\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\left\{ \left[\begin{array}{r} 1 \\ -2 \\ 1 \\ 1 \\ 0 \end{array}\right]\hspace{0.2cm}, \hspace{0.2cm} \left[\begin{array}{r} 1 \\ -2 \\ 0 \\ 0 \\ 1 \end{array}\right] \right\}
\end{eqnarray*}
\end{split}\]</div>
<p><strong>Exercise 6:</strong> Let <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(W\)</span> be the subspaces of <span class="math notranslate nohighlight">\(\mathbb{R}^4\)</span> where <span class="math notranslate nohighlight">\(U\)</span> is the span of <span class="math notranslate nohighlight">\(\{V_1,V_2\}\)</span> and <span class="math notranslate nohighlight">\(W\)</span> is the span of <span class="math notranslate nohighlight">\(\{V_3,V_4\}\)</span>. Determine whether <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(W\)</span> are orthogonal complements of each other.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
V_1 = \left[ \begin{array}{r} 1 \\ 0 \\ 2 \\ 1 \end{array}\right]\hspace{0.7cm}  
V_2 = \left[ \begin{array}{r} 1 \\ -1 \\ 2 \\ 0 \end{array}\right]\hspace{0.7cm} 
V_3 = \left[ \begin{array}{r} -1 \\ 1 \\ 1 \\ -1 \end{array}\right]\hspace{0.7cm}
V_4 = \left[ \begin{array}{r} -2 \\ 0 \\ 1 \\ 0 \end{array}\right]\hspace{0.7cm}
\end{equation}
\end{split}\]</div>
<p><strong>Solution:</strong></p>
<p>First we check if the subspaces <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(W\)</span> are orthogonal to each other. Consider that the matrix <span class="math notranslate nohighlight">\(A\)</span> contains vectors <span class="math notranslate nohighlight">\(V_1\)</span>, <span class="math notranslate nohighlight">\(V_2\)</span> as its columns and the matrix <span class="math notranslate nohighlight">\(B\)</span> contains <span class="math notranslate nohighlight">\(V_3\)</span>, <span class="math notranslate nohighlight">\(V_4\)</span> as its columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Building the matrices A and B:</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>

<span class="n">A_trans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A_trans@B: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">A_trans</span><span class="nd">@B</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A_trans@B: 
 [[0 0]
 [0 0]] 
</pre></div>
</div>
</div>
</div>
<p>The subspaces <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(W\)</span> are orthogonal to each other since <span class="math notranslate nohighlight">\(A^TB\)</span> is a zero matrix. In order to see if <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(W\)</span> are orthogonal complements of each other, we need to find out if <span class="math notranslate nohighlight">\(\{V_1,V_2,V_3,V_4\}\)</span> forms a basis for <span class="math notranslate nohighlight">\(\mathbb{R}^4\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Let C be the matrix with V_1, V_2, V_3, V_4 as its columns:</span>

<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">C_reduced</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">FullRowReduction</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;C: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;C_reduced:  </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">C_reduced</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C: 
 [[ 1  1 -1 -2]
 [ 0 -1  1  0]
 [ 2  2  1  1]
 [ 1  0 -1  0]] 

C_reduced:  
 [[1. 0. 0. 0.]
 [0. 1. 0. 0.]
 [0. 0. 1. 0.]
 [0. 0. 0. 1.]] 
</pre></div>
</div>
</div>
</div>
<p>Since there is a pivot in each row and column of the matrix <span class="math notranslate nohighlight">\(C\)</span> which contains the vectors <span class="math notranslate nohighlight">\(V_1\)</span>, <span class="math notranslate nohighlight">\(V_2\)</span>, <span class="math notranslate nohighlight">\(V_3\)</span> and <span class="math notranslate nohighlight">\(V_4\)</span> as its columns, this means that <span class="math notranslate nohighlight">\(\{V_1,V_2,V_3,V_4\}\)</span> is a basis for <span class="math notranslate nohighlight">\(\mathbb{R}^4\)</span>. Therefore, we can say that the subspaces <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(W\)</span> are orthogonal complements of each other.</p>
<p><strong>Exercise 7:</strong> Find vectors <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(E\)</span> such that <span class="math notranslate nohighlight">\(P\)</span> is in the column space of the matrix <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(E\)</span> is orthogonal to <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(B = P + E\)</span>. Verify your answer.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
A = \left[ \begin{array}{rr} 1 &amp; 2\\ 2 &amp; 1\\ 2 &amp; -2\end{array}\right] \hspace{1cm}
B = \left[ \begin{array}{rr} 1 \\ 1 \\ 1 \end{array}\right]
\end{equation}
\end{split}\]</div>
<p><strong>Solution:</strong></p>
<p>We first find a basis for <span class="math notranslate nohighlight">\(\mathcal{C}(A)\)</span>, the column space of <span class="math notranslate nohighlight">\(A\)</span>.
As there is a pivot in each column of the matrix <span class="math notranslate nohighlight">\(A\)</span>, the two columns of <span class="math notranslate nohighlight">\(A\)</span> form a basis for <span class="math notranslate nohighlight">\(\mathcal{C}(A)\)</span>.
Therefore, we can say that a basis for <span class="math notranslate nohighlight">\(C(A)\)</span> is <span class="math notranslate nohighlight">\(\{X_1,X_2\}\)</span>, where <span class="math notranslate nohighlight">\(X_1\)</span> and <span class="math notranslate nohighlight">\(X_2\)</span> are as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X_1 = \left[ \begin{array}{r} 1 \\ 2 \\ 2  \end{array}\right]\hspace{0.7cm}  
X_2 = \left[ \begin{array}{r} 2 \\ 1 \\ -2 \end{array}\right]\hspace{0.7cm} 
\end{equation}
\end{split}\]</div>
<p>Now <span class="math notranslate nohighlight">\(P\)</span> is the orthogonal projection of <span class="math notranslate nohighlight">\(B\)</span> onto <span class="math notranslate nohighlight">\(\mathcal{C}(A)\)</span>. Once we calculate <span class="math notranslate nohighlight">\(P\)</span>, we can find <span class="math notranslate nohighlight">\(E\)</span> by subtracting the vector <span class="math notranslate nohighlight">\(P\)</span> from the vector <span class="math notranslate nohighlight">\(B\)</span>.  If <span class="math notranslate nohighlight">\(\{U_1,U_2\}\)</span> is an orthonormal basis for <span class="math notranslate nohighlight">\(\mathcal{C}(A)\)</span>, then</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
P =  \langle U_1,B\rangle U_1 + \langle U_2,B\rangle U_2 
\end{equation}
\]</div>
<p>To calculate <span class="math notranslate nohighlight">\(P\)</span>, we therefore need to find the orthonormal basis <span class="math notranslate nohighlight">\(\{U_1,U_2\}\)</span>.  Since <span class="math notranslate nohighlight">\(X_1\cdot X_2 = 0\)</span>, the vectors <span class="math notranslate nohighlight">\(X_1\)</span> and <span class="math notranslate nohighlight">\(X_2\)</span> are orthogonal.  We need to scale <span class="math notranslate nohighlight">\(X_1\)</span> and <span class="math notranslate nohighlight">\(X_2\)</span> to unit length to produce the orthonormal basis <span class="math notranslate nohighlight">\(\{U_1, U_2\}\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
U_1 = \frac{1}{3}\left[ \begin{array}{r} 1 \\ 2 \\ 2  \end{array}\right]\hspace{0.7cm} 
U_2 = \frac{1}{3} \left[ \begin{array}{r} 2 \\ 1 \\ -2 \end{array}\right]\hspace{0.7cm} 
\end{equation}
\end{split}\]</div>
<p>Now <span class="math notranslate nohighlight">\(B\cdot U_1 = \frac{5}{3}\)</span> and <span class="math notranslate nohighlight">\(B\cdot U_2 = \frac{1}{3}\)</span>, so</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
P = \frac{5}{(3)(3)}\left[ \begin{array}{r} 1 \\ 2 \\ 2  \end{array}\right]    + 
\frac{1}{(3)(3)} \left[ \begin{array}{r} 2 \\ 1 \\ -2 \end{array}\right]  =  \frac{1}{9}\left[ \begin{array}{r} 7 \\ 11 \\ 8  \end{array}\right]
\end{equation}
\end{split}\]</div>
<p>Then <span class="math notranslate nohighlight">\(E\)</span> is the difference of <span class="math notranslate nohighlight">\(B\)</span> and <span class="math notranslate nohighlight">\(P\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
E = B-P = \left[ \begin{array}{r} 1 \\ 1 \\ 1  \end{array}\right] -
 \frac{1}{9} \left[ \begin{array}{r} 7 \\ 11 \\ 8 \end{array}\right]  = \frac{1}{9}\left[ \begin{array}{r} 2 \\ -2 \\ 1  \end{array}\right]
\end{equation}
\end{split}\]</div>
<p>If our answers are correct, then <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(E\)</span> must be orthogonal to each other. We can check this in the code cell below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">7</span><span class="o">/</span><span class="mi">9</span><span class="p">],[</span><span class="mi">11</span><span class="o">/</span><span class="mi">9</span><span class="p">],[</span><span class="mi">8</span><span class="o">/</span><span class="mi">9</span><span class="p">]])</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="o">/</span><span class="mi">9</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="mi">9</span><span class="p">],[</span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="p">]])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dot product of P and E is: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">E</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dot product of P and E is: 
 0.0
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 8:</strong> Let <span class="math notranslate nohighlight">\(\{X_1,X_2\}\)</span> be a basis for subspace <span class="math notranslate nohighlight">\(U\)</span> of <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span> and <span class="math notranslate nohighlight">\(\{X_3\}\)</span> be a basis for <span class="math notranslate nohighlight">\(W\)</span>. Find the values of <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> for which subspaces <span class="math notranslate nohighlight">\(U\)</span> are <span class="math notranslate nohighlight">\(W\)</span> are orthogonal complements of each other.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X_1 = \left[ \begin{array}{r} b \\ a \\ 2  \end{array}\right]\hspace{0.7cm}  
X_2 = \left[ \begin{array}{r} 2 \\ -3 \\ 3  \end{array}\right]\hspace{0.7cm} 
X_3 = \left[ \begin{array}{r} 3 \\ b \\ a \end{array}\right]\hspace{0.7cm}
\end{equation}
\end{split}\]</div>
<p><strong>Solution:</strong></p>
<p>For subspaces <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(W\)</span> to be orthogonal to each other, we need <span class="math notranslate nohighlight">\(X_1\cdot X_3 = 0\)</span>, <span class="math notranslate nohighlight">\(X_2\cdot X_3 = 0\)</span>  This gives two equations</p>
<p><span class="math notranslate nohighlight">\(3b + ab + 2a = 0\)</span></p>
<p><span class="math notranslate nohighlight">\(6 - 3b + 3a = 0\)</span></p>
<p>This system of equations is not linear, so we cannot use elimination to find a solution.  We solve the second equation for <span class="math notranslate nohighlight">\(b\)</span> to get <span class="math notranslate nohighlight">\( b = a + 2\)</span>, and substitute the result into the first equation</p>
<p><span class="math notranslate nohighlight">\(3(a + 2) + a(a-2) + 2a  = 0\)</span></p>
<p>This gives a quadratic equation for <span class="math notranslate nohighlight">\(a\)</span>.</p>
<p><span class="math notranslate nohighlight">\( a^2 + 7a + 6 = 0\)</span></p>
<p>The roots of the equation are <span class="math notranslate nohighlight">\( a = -1\)</span> and  <span class="math notranslate nohighlight">\(a=-6\)</span>.</p>
<p>When <span class="math notranslate nohighlight">\(a=-1\)</span>, <span class="math notranslate nohighlight">\(b=1\)</span> and <span class="math notranslate nohighlight">\(X_1\)</span>, <span class="math notranslate nohighlight">\(X_2\)</span> and <span class="math notranslate nohighlight">\(X_3\)</span> are as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X_1 = \left[ \begin{array}{r} 1 \\ -1 \\ 2  \end{array}\right]\hspace{0.7cm}  
X_2 = \left[ \begin{array}{r} 2 \\ -3 \\ 3  \end{array}\right]\hspace{0.7cm} 
X_3 = \left[ \begin{array}{r} 3 \\ 1 \\ -1 \end{array}\right]\hspace{0.7cm}
\end{equation}
\end{split}\]</div>
<p>When <span class="math notranslate nohighlight">\(a=-6\)</span>, <span class="math notranslate nohighlight">\(b=-4\)</span> and <span class="math notranslate nohighlight">\(X_1\)</span>, <span class="math notranslate nohighlight">\(X_2\)</span> and <span class="math notranslate nohighlight">\(X_3\)</span> are as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X_1 = \left[ \begin{array}{r} -4 \\ -6 \\ 2  \end{array}\right]\hspace{0.7cm}  
X_2 = \left[ \begin{array}{r} 2 \\ -3 \\ 3  \end{array}\right]\hspace{0.7cm} 
X_3 = \left[ \begin{array}{r} 3 \\ -4 \\ -6 \end{array}\right]\hspace{0.7cm}
\end{equation}
\end{split}\]</div>
<p>For each pair of <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span> values we need to check that <span class="math notranslate nohighlight">\(\{X_1,X_2,X_3\}\)</span> is a basis for <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span> to determine whether <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(W\)</span> are orthogonal complements.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Building matrix A with X_1, X_2, X_3 as its columns when a = -1, b = 1:</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">A_reduced</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">FullRowReduction</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A_reduced: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">A_reduced</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>


<span class="c1">## Building the matrix B with X_1, X_2, X_3 as its columns when a = -6, b = -4:</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">]])</span>
<span class="n">B_reduced</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">FullRowReduction</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;B_reduced: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">B_reduced</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A_reduced: 
 [[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]] 

B_reduced: 
 [[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]] 
</pre></div>
</div>
</div>
</div>
<p>Since there is a pivot in each row and column of the matrices <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>, <span class="math notranslate nohighlight">\(\{X_1,X_2,X_3\}\)</span> is a basis for <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span> in both cases.</p>
<p><strong>Exercise 9:</strong> Let <span class="math notranslate nohighlight">\(U\)</span> be a subspace of <span class="math notranslate nohighlight">\(\mathbb{R}^4\)</span> and it has <span class="math notranslate nohighlight">\(3\)</span> vectors in its basis. Can you determine the number of vectors in the basis of <span class="math notranslate nohighlight">\(U^{\perp}\)</span>?</p>
<p><strong>Solution:</strong></p>
<p>The basis for <span class="math notranslate nohighlight">\(U\)</span> and the basis for <span class="math notranslate nohighlight">\(U^{\perp}\)</span> should together be the basis for <span class="math notranslate nohighlight">\(\mathbb{R}^4\)</span>.  This means that <span class="math notranslate nohighlight">\( dim(U) + dim(U^{\perp}) = dim(\mathbb{R}^4)\)</span>.  Since <span class="math notranslate nohighlight">\(dim(\mathbb{R}^4) = 4\)</span>, <span class="math notranslate nohighlight">\( dim(U^{\perp}) = 1\)</span>.  Therefore, any basis of <span class="math notranslate nohighlight">\(U^{\perp}\)</span> contains only one vector.</p>
<p><strong>Exercise 10:</strong> Let <span class="math notranslate nohighlight">\(U\)</span> of <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span> spanned by <span class="math notranslate nohighlight">\(\{X_1,X_2\}\)</span>.  Decompose the vector <span class="math notranslate nohighlight">\(V\)</span> in <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span> such that one component is in subspace <span class="math notranslate nohighlight">\(U\)</span> and other component in <span class="math notranslate nohighlight">\(U^{\perp}\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X_1 = \left[ \begin{array}{r} 1 \\ 0 \\ 1 \end{array}\right]\hspace{0.7cm}  
X_2 = \left[ \begin{array}{r} 2 \\ 2 \\ 3 \end{array}\right]\hspace{0.7cm} 
V = \left[ \begin{array}{r} -1 \\ 0 \\ 8 \end{array}\right]\hspace{0.7cm} 
\end{equation}
\end{split}\]</div>
<p><strong>Solution:</strong></p>
<p>We would first start by finding a basis for <span class="math notranslate nohighlight">\(U^{\perp}\)</span>. Let <span class="math notranslate nohighlight">\(\{X_3\}\)</span> be a vector <span class="math notranslate nohighlight">\(U^{\perp}\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X_3 = \left[ \begin{array}{r} a \\ b \\ c  \end{array}\right]\hspace{0.7cm}  
\end{equation}
\end{split}\]</div>
<p>Since <span class="math notranslate nohighlight">\(U^{\perp}\)</span> is the orthogonal complement of <span class="math notranslate nohighlight">\(U\)</span>, <span class="math notranslate nohighlight">\(X_1\cdot X_3 = 0\)</span> and <span class="math notranslate nohighlight">\(X_2\cdot X_3 = 0\)</span>.</p>
<p><span class="math notranslate nohighlight">\( a + c = 0\)</span></p>
<p><span class="math notranslate nohighlight">\( 2a + 2b + 3c = 0\)</span></p>
<p>In this system of equations, we observe that <span class="math notranslate nohighlight">\(c\)</span> is a free variable, and let <span class="math notranslate nohighlight">\(c = t\)</span> where <span class="math notranslate nohighlight">\(t\)</span>. We then find <span class="math notranslate nohighlight">\( a = -t\)</span> and <span class="math notranslate nohighlight">\(b = -t/2\)</span>.  Since we only need one specific vector to form a basis for <span class="math notranslate nohighlight">\(U^{\perp}\)</span>, we let <span class="math notranslate nohighlight">\(t=2\)</span> and</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X_3 = \left[ \begin{array}{r} -2 \\  -1 \\ 2  \end{array}\right]\hspace{0.7cm}  
\end{equation}
\end{split}\]</div>
<p>Now <span class="math notranslate nohighlight">\(\{X_1,X_2,X_3\}\)</span> is a basis for <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span> and <span class="math notranslate nohighlight">\(V\)</span> is a linear combination of the basis vectors.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
V =\left[ \begin{array}{r} -1 \\ 0 \\ 8  \end{array}\right]= a\left[ \begin{array}{r} 1 \\ 0 \\ 1  \end{array}\right]  +  
 b \left[ \begin{array}{r} 2 \\ 2 \\ 3 \end{array}\right]  + 
  c \left[ \begin{array}{r} -2 \\ -1 \\ 2 \end{array}\right]
\end{equation}
\end{split}\]</div>
<p>We solve a system of equations to get the values of <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(c\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Building the matrix A with X_1,X_2, X_3 as its columns and B represents the vector V:</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">8</span><span class="p">]])</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">SolveSystem</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;X: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X: 
 [[1.]
 [1.]
 [2.]] 
</pre></div>
</div>
</div>
</div>
<p>Therefore,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
V = 1\left[ \begin{array}{r} 1 \\ 0 \\ 1  \end{array}\right]  +  
 1 \left[ \begin{array}{r} 2 \\ 2 \\ 3 \end{array}\right]  + 
  2 \left[ \begin{array}{r} -2 \\ -1 \\ 2 \end{array}\right]
\end{equation}
\end{split}\]</div>
<p>Let <span class="math notranslate nohighlight">\( V = V_1 + V_2\)</span> with <span class="math notranslate nohighlight">\(V_1\)</span> in the subspace <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(V_2\)</span> in the orthogonal complement <span class="math notranslate nohighlight">\(U^{\perp}\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
V_1 = 1\left[ \begin{array}{r} 1 \\ 0 \\ 1  \end{array}\right]  +  
 1 \left[ \begin{array}{r} 2 \\ 2 \\ 3 \end{array}\right]  = 
  \left[ \begin{array}{r} 3 \\ 2 \\ 4 \end{array}\right] \hspace{1cm}
V_2 = 2 \left[ \begin{array}{r} -2 \\ -1 \\ 2 \end{array}\right] = 
\left[ \begin{array}{r} -4 \\ -2 \\ 4  \end{array}\right]  
\end{equation}
\end{split}\]</div>
<p><strong>Exercise 11:</strong></p>
<p>(<span class="math notranslate nohighlight">\(a\)</span>) Find a basis for each of the four of fundamental subspaces (<span class="math notranslate nohighlight">\(\mathcal{C}(A)\)</span>, <span class="math notranslate nohighlight">\(\mathcal{N}(A)\)</span>, <span class="math notranslate nohighlight">\(\mathcal{R}(A)\)</span>, and <span class="math notranslate nohighlight">\(\mathcal{N}(A^T)\)</span>) associated with <span class="math notranslate nohighlight">\(A\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
A = \left[ \begin{array}{r} 1 &amp; 1 &amp; 0 &amp; 2 &amp; -1 \\ 1 &amp; 0 &amp; 1 &amp; -1 &amp; 0 \\ 3 &amp; 1 &amp; 2 &amp; 0 &amp; -1 \end{array}\right] 
\end{equation}
\end{split}\]</div>
<p><strong>Solution:</strong>  First we use <span class="math notranslate nohighlight">\(\texttt{FullRowReduction}\)</span> to reduce <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(A^T\)</span> into RREF forms.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">A_reduced</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">FullRowReduction</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">A_transpose</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">A_transpose_reduced</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">FullRowReduction</span><span class="p">(</span><span class="n">A_transpose</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A_reduced</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A_transpose_reduced</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1.  0.  1. -1.  0.]
 [ 0.  1. -1.  3. -1.]
 [ 0.  0.  0.  0.  0.]] 

[[1. 0. 1.]
 [0. 1. 2.]
 [0. 0. 0.]
 [0. 0. 0.]
 [0. 0. 0.]]
</pre></div>
</div>
</div>
</div>
<p>We know that the linearly independent columns of <span class="math notranslate nohighlight">\(A\)</span> form a basis for the columns of <span class="math notranslate nohighlight">\(A\)</span>, and the pivot columns are precisely those vectors. Therefore the following is a basis for <span class="math notranslate nohighlight">\(\mathcal{C}(A)\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\left\{ \left[\begin{array}{r} 1 \\ 1 \\ 3 \end{array}\right]\hspace{0.2cm}, \hspace{0.2cm} \left[\begin{array}{r} 1 \\ 0 \\ 1 \end{array}\right] \right\}
\end{eqnarray*}
\end{split}\]</div>
<p>Similarily, the set of pivot columns of <span class="math notranslate nohighlight">\(A^T\)</span> forms a basis for <span class="math notranslate nohighlight">\(\mathcal{R}(A)\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\left\{ \left[\begin{array}{r} 1 \\ 1 \\ 0 \\ 2 \\ -1 \end{array}\right]\hspace{0.2cm}, \hspace{0.2cm} \left[\begin{array}{r} 1 \\ 0 \\ 1 \\ -1 \\ 0 \end{array}\right] \right\}
\end{eqnarray*}
\end{split}\]</div>
<p>Recall that to find a basis for <span class="math notranslate nohighlight">\(\mathcal{N}(A)\)</span> we first find the solutions to <span class="math notranslate nohighlight">\(AX = 0\)</span>. We start by forming the appropriate augmented matrix and then finding its RREF form.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_augmented</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">A_augmented_reduced</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">FullRowReduction</span><span class="p">(</span><span class="n">A_augmented</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A_augmented_reduced</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1.  0.  1. -1.  0.  0.]
 [ 0.  1. -1.  3. -1.  0.]
 [ 0.  0.  0.  0.  0.  0.]]
</pre></div>
</div>
</div>
</div>
<p>There exist pivots in the first two columns only, so <span class="math notranslate nohighlight">\(x_3,x_4,\)</span> and <span class="math notranslate nohighlight">\(x_5\)</span> are free variables. If we parametrize them as <span class="math notranslate nohighlight">\(x_3 = r\)</span>, <span class="math notranslate nohighlight">\(x_4 = s\)</span>, and <span class="math notranslate nohighlight">\(x_5 = t\)</span> then <span class="math notranslate nohighlight">\(x_1 = -r + s\)</span> and <span class="math notranslate nohighlight">\(x_2 = r -3s + t\)</span>. Then we can write the components of a general solution vector <span class="math notranslate nohighlight">\(X\)</span> in terms of these parameters.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X = \left[ \begin{array}{r} x_1 \\ x_ 2 \\ x_ 3 \\ x_4 \\ x_5 \end{array}\right] =  
r\left[ \begin{array}{r} -1 \\ 1 \\  1 \\ 0 \\ 0 \end{array}\right] +
s\left[ \begin{array}{r} 1 \\ -3 \\ 0 \\ 1 \\ 0 \end{array}\right] +
t\left[ \begin{array}{r} 0 \\ 1 \\ 0 \\ 0 \\ 1 \end{array}\right]
\end{equation}
\end{split}\]</div>
<p>Therefore the follow set of vectors forms a basis for <span class="math notranslate nohighlight">\(\mathcal{N}(A)\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\left\{ \left[\begin{array}{r} -1 \\ 1 \\ 1 \\ 0 \\ 0 \end{array}\right]\hspace{0.2cm}, \hspace{0.2cm} \left[\begin{array}{r} 1 \\ -3 \\ 0 \\ 1 \\ 0 \end{array}\right]\hspace{0.2cm}, \hspace{0.2cm} \left[\begin{array}{r} 0 \\ 1 \\ 0 \\ 0 \\ 1 \end{array}\right] \right\}
\end{eqnarray*}
\end{split}\]</div>
<p>Similarily, to find a basis for <span class="math notranslate nohighlight">\(\mathcal{N}(A^T)\)</span> we must find the solutions to <span class="math notranslate nohighlight">\(A^TX = 0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_transpose_augmented</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">A_transpose_augmented_reduced</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">FullRowReduction</span><span class="p">(</span><span class="n">A_transpose_augmented</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A_transpose_augmented_reduced</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1. 0. 1. 0.]
 [0. 1. 2. 0.]
 [0. 0. 0. 0.]
 [0. 0. 0. 0.]
 [0. 0. 0. 0.]]
</pre></div>
</div>
</div>
</div>
<p>There exists pivots in the first two columns only, so <span class="math notranslate nohighlight">\(x_3\)</span> is a free variable. If we parametrize <span class="math notranslate nohighlight">\(x_3 = r\)</span> then <span class="math notranslate nohighlight">\(x_1 = -r\)</span> and <span class="math notranslate nohighlight">\(x_2 = -2r\)</span>. Then we can write the components of a general solution vector <span class="math notranslate nohighlight">\(X\)</span> in terms of <span class="math notranslate nohighlight">\(r\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X = \left[ \begin{array}{r} x_1 \\ x_ 2 \\ x_ 3 \end{array}\right] =  
r\left[ \begin{array}{r} -1 \\ -2 \\  1 \end{array}\right]
\end{equation}
\end{split}\]</div>
<p>Therefore the following set forms a basis for <span class="math notranslate nohighlight">\(\mathcal{N}(A^T)\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\left\{ \left[\begin{array}{r} -1 \\ -2 \\ 1 \end{array}\right] \right\}
\end{eqnarray*}
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\((b)\)</span> Show that each of the basis vectors of <span class="math notranslate nohighlight">\(\mathcal{R}(A)\)</span> are orthogonal to all of the basis vectors of <span class="math notranslate nohighlight">\(\mathcal{N}(A)\)</span>.</p>
<p><strong>Solution:</strong></p>
<p>To show that each of the basis vectors of <span class="math notranslate nohighlight">\(\mathcal{R}(A)\)</span> are orthogonal to all of the basis vectors of <span class="math notranslate nohighlight">\(\mathcal{N}(A)\)</span>, we must take all of their dot products and verify that the result is 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">R2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">N1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">N2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">N3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">R1</span><span class="p">,</span><span class="n">N1</span><span class="p">),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">R1</span><span class="p">,</span><span class="n">N2</span><span class="p">),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">R1</span><span class="p">,</span><span class="n">N3</span><span class="p">),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">R2</span><span class="p">,</span><span class="n">N1</span><span class="p">),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">R2</span><span class="p">,</span><span class="n">N2</span><span class="p">),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">R2</span><span class="p">,</span><span class="n">N3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0 

0.0 

0.0 

0.0 

0.0 

0.0
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\((c)\)</span> Show that each of the basis vectors of <span class="math notranslate nohighlight">\(\mathcal{C}(A)\)</span> are orthogonal to all of the basis vectors of <span class="math notranslate nohighlight">\(\mathcal{N}(A^T)\)</span>.</p>
<p><strong>Solution:</strong></p>
<p>To show that each of the basis vectors of <span class="math notranslate nohighlight">\(\mathcal{C}(A)\)</span> are orthogonal to all of the basis vectors of <span class="math notranslate nohighlight">\(\mathcal{N}(A^T)\)</span>, we must take all of their dot products and verify that the result is 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">]])</span>
<span class="n">C2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">C1</span><span class="p">,</span><span class="n">N</span><span class="p">),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">C2</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0 

0.0
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 12:</strong> The equation <span class="math notranslate nohighlight">\(x + 2y - 3z = 0\)</span> defines a plane in <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span>.</p>
<p><span class="math notranslate nohighlight">\((a)\)</span> Find a matrix that has this plane as its null space. Is the matrix unique?</p>
<p><strong>Solution:</strong></p>
<p>Let <span class="math notranslate nohighlight">\(A = \left[ \begin{array}{r} 1 &amp; 2 &amp; -3 \end{array}\right] \)</span> and <span class="math notranslate nohighlight">\(X\)</span> be a vector in <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span> with unspecified entries.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X = \left[ \begin{array}{r} x \\ y \\ z \end{array}\right]
\end{equation}
\end{split}\]</div>
<p>The vector <span class="math notranslate nohighlight">\(X\)</span> is in the null space of <span class="math notranslate nohighlight">\(A\)</span> if <span class="math notranslate nohighlight">\(AX = 0\)</span>. Since <span class="math notranslate nohighlight">\(AX = x + 2y - 3z\)</span>, the vector <span class="math notranslate nohighlight">\(X\)</span> is in the null space precisely when its entries satisfy the equation of the plane.  The <span class="math notranslate nohighlight">\(1\times 3\)</span> matrix <span class="math notranslate nohighlight">\(A\)</span> is not the only matrix with this feature however, as any scalar multiple of <span class="math notranslate nohighlight">\(A\)</span> will work.  In addition, any <span class="math notranslate nohighlight">\(m \times 3\)</span> matrix with at least one nonzero scalar multiple of <span class="math notranslate nohighlight">\(A\)</span> as one of its rows, and whose other rows are also scalar multiples of <span class="math notranslate nohighlight">\(A\)</span>, will work. For example the following matrix also has this plane as its null space.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\left[ \begin{array}{rrr} 1 &amp; 2 &amp; -3 \\ 0 &amp; 0 &amp; 0 \\ 3 &amp; 6 &amp; -9 \\ -2 &amp; -4 &amp; 6 \end{array}\right]
\end{equation}
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\((b)\)</span> Find a matrix that has this plane as its row space. Is the matrix unique?</p>
<p>If we parametrize <span class="math notranslate nohighlight">\(y = r\)</span> and <span class="math notranslate nohighlight">\(z = s\)</span> then for any given point on the plane, <span class="math notranslate nohighlight">\(x = -2r + 3s\)</span>. Then we can write the components of a general vector  <span class="math notranslate nohighlight">\(X\)</span>  in the plane in terms of these parameters.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X = 
r\left[ \begin{array}{r} -2 \\ 1 \\ 0 \end{array}\right] + s\left[ \begin{array}{r} 3 \\ 0 \\  1 \end{array}\right]
\end{equation}
\end{split}\]</div>
<p>If we let <span class="math notranslate nohighlight">\(A\)</span> be the matrix defined below then the span of the rows of <span class="math notranslate nohighlight">\(A\)</span>, or in other words the row space of <span class="math notranslate nohighlight">\(A\)</span>, will be precisely the points on the given plane. <span class="math notranslate nohighlight">\(A\)</span> is not the unique matrix with this feature, however, as any other matrix that was reached by applying <strong>matrix row operations</strong> on <span class="math notranslate nohighlight">\(A\)</span> will also work.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
A = \left[ \begin{array}{rrr} -2 &amp; 1 &amp; 0 \\ 3 &amp; 0 &amp; 1 \end{array}\right]
\end{equation}
\end{split}\]</div>
<p>In addition, similarly to part <span class="math notranslate nohighlight">\((a)\)</span>, any <span class="math notranslate nohighlight">\(m \times 3\)</span> matrix with at least one nonzero scalar multiple of each of the rows of <span class="math notranslate nohighlight">\(A\)</span> as two of its rows, and whose other rows are linear combinations of the rows of <span class="math notranslate nohighlight">\(A\)</span>, will work. For example the following matrix also has this plane as its row space.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\left[ \begin{array}{rrr} -2 &amp; 1 &amp; 0 \\ 6 &amp; 0 &amp; 2 \\ 1 &amp; 1 &amp; 1 \end{array}\right]
\end{equation}
\end{split}\]</div>
</div>
<div class="section" id="least-squares-solutions">
<h2>Least Squares Solutions<a class="headerlink" href="#least-squares-solutions" title="Permalink to this headline">¶</a></h2>
<p><strong>Exercise 1:</strong> Verify that the following system is inconsistent, then find the least squares solution.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
    x_2 + x_3 &amp; = &amp; 3 \\
3x_1 - x_2 - 2x_3 &amp; = &amp; 2 \\
x_1 - 2x_2 - x_3 &amp; = &amp; 1 \\
4x_1 + 2x_2 + 4x_3 &amp; = &amp; 0
\end{eqnarray*}
\end{split}\]</div>
<p><strong>Solution:</strong></p>
<p>Let <span class="math notranslate nohighlight">\(A\)</span> be the <span class="math notranslate nohighlight">\(4 \times 3\)</span> coefficient matrix, and let B be the vector of the right-hand sides of the equations. To verify that the system is indeed inconsistent, we can compute the RREF of the augmented matrix <span class="math notranslate nohighlight">\([A|B].\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_augmented</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">A_augmented_reduced</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">FullRowReduction</span><span class="p">(</span><span class="n">A_augmented</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A_augmented_reduced</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1. 0. 0. 0.]
 [0. 1. 0. 0.]
 [0. 0. 1. 0.]
 [0. 0. 0. 1.]]
</pre></div>
</div>
</div>
</div>
<p>The pivot in the final column indicates that this system is inconsistent. To find the least squares solution, we will construct and solve the normal equations, <span class="math notranslate nohighlight">\(A^TAX = A^TB\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>

<span class="n">N_A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@A</span>
<span class="n">N_B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@B</span>

<span class="nb">print</span><span class="p">(</span><span class="n">N_A</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">N_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[26  3  9]
 [ 3 10 13]
 [ 9 13 22]] 

[[ 7]
 [-1]
 [-2]]
</pre></div>
</div>
</div>
</div>
<p>The normal equations are a <span class="math notranslate nohighlight">\(3 \times 3\)</span> system, which can be solved using elimination.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
26x_1 + 3x_2 + 9x_3 &amp; = &amp; 7 \\
3x_1 + 10x_2 + 13x_3 &amp; = &amp; -1\\
9x_1 + 13x_2 + 22x_3 &amp; = &amp; -2
\end{eqnarray*}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_hat</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">SolveSystem</span><span class="p">(</span><span class="n">N_A</span><span class="p">,</span><span class="n">N_B</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_hat</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">A</span><span class="nd">@X_hat</span> <span class="o">-</span> <span class="n">B</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Magnitude of minimum error is:&quot;</span><span class="p">,</span><span class="n">lag</span><span class="o">.</span><span class="n">Magnitude</span><span class="p">(</span><span class="n">E</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 0.4       ]
 [ 0.47843137]
 [-0.5372549 ]] 

Magnitude of minimum error is: 3.256366313642777
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 2:</strong> Another way to compute <span class="math notranslate nohighlight">\(\hat{B}\)</span> is to find an orthogonal basis for <span class="math notranslate nohighlight">\(\mathcal{C}(A)\)</span>, find the projection of <span class="math notranslate nohighlight">\(B\)</span> in the direction of each of those basis elements, and then add up these projections.  Demonstrate this calculation using <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> from <strong>Example 2</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">A_reduced</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">FullRowReduction</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A_reduced</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1. 0.]
 [0. 1.]
 [0. 0.]
 [0. 0.]]
</pre></div>
</div>
</div>
</div>
<p>There is a pivot in every column, so the columns of <span class="math notranslate nohighlight">\(A\)</span> are linearly independent and thus form a basis for <span class="math notranslate nohighlight">\(\mathcal{C}(A)\)</span>. To find an orthogonal basis, we want to find the component of first column that is orthogonal to the second column. We do so by finding the projection of the first column in the direction of the second column, and then subtracting this from the first column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">5</span><span class="p">]])</span>
<span class="n">A2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>

<span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span><span class="n">A2</span><span class="p">)</span><span class="o">/</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">A2</span><span class="p">,</span><span class="n">A2</span><span class="p">))</span><span class="o">*</span><span class="n">A2</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">A1</span> <span class="o">-</span> <span class="n">k</span>
<span class="nb">print</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 0.4]
 [ 3.6]
 [-0.2]
 [ 1.8]]
</pre></div>
</div>
</div>
</div>
<p>Therefore <span class="math notranslate nohighlight">\(\{E,A_2\}\)</span> is an orthogonal basis for the column space of <span class="math notranslate nohighlight">\(A\)</span>. Now we find the projection of <span class="math notranslate nohighlight">\(B\)</span> in the direction of each of these basis elements and add them together.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B_hat</span> <span class="o">=</span> <span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">A2</span><span class="p">)</span><span class="o">/</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">A2</span><span class="p">,</span><span class="n">A2</span><span class="p">))</span><span class="o">*</span><span class="n">A2</span> <span class="o">+</span> <span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">E</span><span class="p">)</span><span class="o">/</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">E</span><span class="p">))</span><span class="o">*</span><span class="n">E</span>
<span class="nb">print</span><span class="p">(</span><span class="n">B_hat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-0.31707317]
 [ 1.14634146]
 [-0.84146341]
 [-0.42682927]]
</pre></div>
</div>
</div>
</div>
<p>We now solve the system <span class="math notranslate nohighlight">\(A\hat{X} = \hat{B}\)</span> by forming the appropriate augmented matrix and using <span class="math notranslate nohighlight">\(\texttt{FullRowReduction}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">A</span><span class="p">,</span><span class="n">B_hat</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">FullRowReduction</span><span class="p">(</span><span class="n">C</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1.          0.          0.20731707]
 [ 0.          1.         -0.73170732]
 [ 0.          0.          0.        ]
 [ 0.          0.          0.        ]]
</pre></div>
</div>
</div>
</div>
<p>Therefore we have that <span class="math notranslate nohighlight">\(\hat{X}\)</span> is equal to the following vector, which agrees with the solution to the normal equations.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\hat{X} = \left[ \begin{array}{c} 0.20731707 \\ -0.73170732\end{array}\right]
\end{equation}
\end{split}\]</div>
<p><strong>Exercise 3:</strong> Explain why an inconsistent system, <span class="math notranslate nohighlight">\(AX=B\)</span>, does not have a unique least squares solution if the columns of <span class="math notranslate nohighlight">\(A\)</span> are linearly dependent.</p>
<p><strong>Solution:</strong></p>
<p>If the columns of <span class="math notranslate nohighlight">\(A\)</span> are linearly dependent, then there exists some nonzero <span class="math notranslate nohighlight">\(x\)</span> such that <span class="math notranslate nohighlight">\(Ax = 0\)</span>. For this same <span class="math notranslate nohighlight">\(x\)</span>, we have that <span class="math notranslate nohighlight">\(A^TAx = A^T0 = 0\)</span> and so the columns of <span class="math notranslate nohighlight">\(A^TA\)</span> must also be linearly dependent. But recall that a general system <span class="math notranslate nohighlight">\(CX = D\)</span> has a unique solution if and only if the columns of <span class="math notranslate nohighlight">\(C\)</span> are linearly independent, and thus <span class="math notranslate nohighlight">\(A^TAX = A^TB\)</span> does not have a unique solution. This means that <span class="math notranslate nohighlight">\(AX=B\)</span> does not have a unique least squares solution.</p>
<p><strong>Exercise 4:</strong> Demonstrate that the following inconsistent system does not have a unique least squares solution.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
    x_2 - x_3 &amp; = &amp; 3 \\
3x_1 - x_2 + 4x_3 &amp; = &amp; 2 \\
x_1 - 2x_2 + 3x_3 &amp; = &amp; 1 \\
4x_1 + 2x_2 + 2x_3 &amp; = &amp; 0
\end{eqnarray*}
\end{split}\]</div>
<p><strong>Solution:</strong></p>
<p>This can be seen quite easily if we utilize <strong>normal equations</strong>. Let <span class="math notranslate nohighlight">\(A\)</span> be the <span class="math notranslate nohighlight">\(4 \times 3\)</span> coefficient matrix, and let B be the vector of the right-hand sides of the equations. Now we construct and solve the normal equations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">N_A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@A</span>
<span class="n">N_B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@B</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">N_A</span><span class="p">,</span><span class="n">N_B</span><span class="p">])</span>
<span class="n">C_reduced</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">FullRowReduction</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">C_reduced</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1.          0.          1.          0.29083665]
 [ 0.          1.         -1.         -0.187251  ]
 [ 0.          0.          0.          0.        ]]
</pre></div>
</div>
</div>
</div>
<p>This system has no pivots in the last column so it is consistent, but it also has no pivot in the third column which means there is a free variable, and thus an infinite number of solutions.</p>
<p><strong>Exercise 5:</strong> If the system <span class="math notranslate nohighlight">\(AX = B\)</span> is inconsistent, find the least squares solution to it and determine whether or not the least squares solution is unique.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
A = \left[\begin{array}{rr} 1 &amp; 2 &amp; 3 \\ 1 &amp; 1 &amp; 1 \\ 2 &amp; 2 &amp; 0 \\ 1 &amp; 2 &amp; 1 \end{array}\right]
\quad\quad
B = \left[\begin{array}{r} 1 \\1 \\ 1 \\ 1 \end{array}\right]  
\end{equation}
\end{split}\]</div>
<p><strong>Solution:</strong></p>
<p>First we check if the given system is consistent.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Building the matrix A:</span>

<span class="n">A_aug</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">A_aug_red</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">FullRowReduction</span><span class="p">(</span><span class="n">A_aug</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The reduced form of A_aug is: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">A_aug_red</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The reduced form of A_aug is: 
 [[1. 0. 0. 0.]
 [0. 1. 0. 0.]
 [0. 0. 1. 0.]
 [0. 0. 0. 1.]] 
</pre></div>
</div>
</div>
</div>
<p>The pivot in last column of the augmented matrix shows that the given system is inconsistent.  As there is a pivot in each column of the matrix <span class="math notranslate nohighlight">\(A\)</span>, we know that the columns are linearly independent and we should expect the least squares solution to be unique.  We find the least squares solution by using the normal equations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Building the matrix A and B:</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">A_trans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">A_trans</span><span class="nd">@A</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">A_trans</span><span class="nd">@B</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">SolveSystem</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;X: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X: 
 [[0.42857143]
 [0.14285714]
 [0.14285714]] 
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 6:</strong> Find the equation of the line that best fits through the three given points:  <span class="math notranslate nohighlight">\((0,2), (0,3)\)</span> and <span class="math notranslate nohighlight">\((1,4)\)</span> in the sense of least squares.</p>
<p><strong>Solution:</strong></p>
<p>The general equation of a line is <span class="math notranslate nohighlight">\(y = mx + c\)</span>.  Plugging in the given values of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>, we get three equations in <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(c\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
    (0)m + c &amp; = &amp; 2 \\
(0)m  + c &amp; = &amp; 3 \\
(1)m + c &amp; = &amp; 4 \\
\end{eqnarray*}
\end{split}\]</div>
<p>The system of equations has no solution because <span class="math notranslate nohighlight">\(c = 2\)</span> from the first equation and <span class="math notranslate nohighlight">\(c = 3\)</span> from the second equation.</p>
<p>The corresponding matrix equation is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
AX = \left[\begin{array}{rr} 0 &amp; 1  \\ 0 &amp; 1 \\ 1 &amp; 1 \end{array}\right]\left[\begin{array}{r} m \\c  \end{array}\right] = \left[\begin{array}{r} 2 \\3 \\ 4  \end{array}\right]   = B 
\end{equation}
\end{split}\]</div>
<p>Now, we can find the least squares solution using the normal equations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Building the matrix A:</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">]])</span>

<span class="n">A_trans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="n">C</span> <span class="o">=</span> <span class="n">A_trans</span><span class="nd">@A</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">A_trans</span><span class="nd">@B</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">SolveSystem</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;X: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">X</span> <span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X: 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [[1.5]
 [2.5]] 
</pre></div>
</div>
</div>
</div>
<p>The equation of the line that best fits through the given points is <span class="math notranslate nohighlight">\(y = 1.5x + 2.5\)</span>.</p>
<p><strong>Exercise 7:</strong> Find the equation of the parabola that best fits through the given points: <span class="math notranslate nohighlight">\((-1,2), (1,0), (3,1)\)</span> and <span class="math notranslate nohighlight">\((4,2)\)</span> in the sense of least squares.</p>
<p><strong>Solution:</strong></p>
<p>The general equation of a parabola is <span class="math notranslate nohighlight">\(y = ax^2 + bx + c\)</span>.  Plugging in the given values of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>, we get equations in <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, and <span class="math notranslate nohighlight">\(c\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
    a \,\,\,- b\,\,\,  + c &amp; = &amp; 2 \\
a \,\,\,+ b\,\,\, + c &amp; = &amp; 0 \\
9a + 3b + c &amp; = &amp; 1 \\
16a + 4b + c &amp; = &amp; 2 \\
\end{eqnarray*}
\end{split}\]</div>
<p>The corresponding matrix equation is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
AX = 
\left[\begin{array}{rr} 1 &amp; -1 &amp; 1  \\ 1 &amp; 1 &amp; 1 \\ 9 &amp; 3 &amp; 1 \\ 16 &amp; 4 &amp; 1 \end{array}\right]\left[\begin{array}{r} a \\b \\ c \end{array}\right] = 
\left[\begin{array}{r} 2 \\0 \\ 1 \\ 2  \end{array}\right]   = B 
\end{equation}
\end{split}\]</div>
<p>We first determine if the system is consistent.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_aug</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">16</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">A_aug_red</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">FullRowReduction</span><span class="p">(</span><span class="n">A_aug</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The reduced form of A_aug is: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">A_aug_red</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The reduced form of A_aug is: 
 [[1. 0. 0. 0.]
 [0. 1. 0. 0.]
 [0. 0. 1. 0.]
 [0. 0. 0. 1.]] 
</pre></div>
</div>
</div>
</div>
<p>The pivot in the last column of the augmented matrix shows that the given system is inconsistent. We next find the least squares solution. Since there is a pivot in each column of the cofficient matrix <span class="math notranslate nohighlight">\(A\)</span>, the columns of <span class="math notranslate nohighlight">\(A\)</span> are linearly independent and there is a unique least squares solution to this system.</p>
<p>We find the solution using the normal equations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Building the matrices A and B:</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">16</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>

<span class="n">A_trans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="n">C</span> <span class="o">=</span> <span class="n">A_trans</span><span class="nd">@A</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">A_trans</span><span class="nd">@B</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">SolveSystem</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;X: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X: 
 [[ 0.31532663]
 [-0.91834171]
 [ 0.72864322]] 
</pre></div>
</div>
</div>
</div>
<p>We have got the values of <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span> and <span class="math notranslate nohighlight">\(c\)</span> from the computations done in the above code cell. Therefore, the equation of the parabola that best fits through the given points is <span class="math notranslate nohighlight">\(y  = 0.315x^2  - 0.918x + 0.72864\)</span>.</p>
<p><strong>Exercise 8:</strong> Find the least squares solution for the given system <span class="math notranslate nohighlight">\(AX = B\)</span> without using the normal equations. Instead, find the orthogonal projection of <span class="math notranslate nohighlight">\(B\)</span> onto <span class="math notranslate nohighlight">\(C(A)\)</span> to find the least squares solution. Is the solution unique?</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
A = \left[\begin{array}{rr} 1 &amp; 2 &amp; 2 \\ 2 &amp; 1 &amp; 4 \\ 1 &amp; 2 &amp; 2 \end{array}\right]
\quad\quad
B= \left[\begin{array}{r} 1 \\1 \\ 2 \end{array}\right] 
\end{equation}
\end{split}\]</div>
<p><strong>Solution:</strong></p>
<p>Let us first look at the columns of the matrix <span class="math notranslate nohighlight">\(A\)</span>. If the columns of <span class="math notranslate nohighlight">\(A\)</span> are linearly independent, then there will be a unique solution for the system. If the columns are linearly dependent, there are infinitely many least square solutions to the system.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Building the matrix A:</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">A_red</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">FullRowReduction</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A_red: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">A_red</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A_red: 
 [[1. 0. 2.]
 [0. 1. 0.]
 [0. 0. 0.]] 
</pre></div>
</div>
</div>
</div>
<p>Since there is no pivot in the third column since the third column we should expect infintely many least square solutions for the given system.</p>
<p>Since there are pivots in two columns of <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(dim(C(A) = 2\)</span>. The basis for <span class="math notranslate nohighlight">\(C(A)\)</span> is <span class="math notranslate nohighlight">\(\{C_1,C_2\}\)</span> where</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
C_1 = \left[\begin{array}{r} 1 \\ 2 \\ 1  \end{array}\right]  \hspace{1cm}
C_2 = \left[\begin{array}{r} 2 \\ 1 \\ 2  \end{array}\right]  
\end{equation}
\end{split}\]</div>
<p>Let the orthonormal basis for <span class="math notranslate nohighlight">\(C(A)\)</span> is: <span class="math notranslate nohighlight">\(\{U_1,U_2\}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Building the vectors B, C_1, C_2:</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">C_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">C_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>


<span class="c1">## V_1, V_2 are orthogonal basis vectors for C(A):</span>


<span class="n">V_1</span> <span class="o">=</span> <span class="n">C_1</span>
<span class="n">V_2</span> <span class="o">=</span> <span class="n">C_2</span> <span class="o">-</span> <span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">V_1</span><span class="p">,</span> <span class="n">C_2</span><span class="p">)</span><span class="o">/</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">V_1</span><span class="p">,</span><span class="n">V_1</span><span class="p">))</span><span class="o">*</span><span class="n">V_1</span>

<span class="c1"># Building U_1,U_2 by scaling V_1, V_2:</span>

<span class="n">U_1</span> <span class="o">=</span> <span class="n">V_1</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">V_1</span><span class="p">,</span><span class="n">V_1</span><span class="p">))</span>
<span class="n">U_2</span> <span class="o">=</span> <span class="n">V_2</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">V_2</span><span class="p">,</span> <span class="n">V_2</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;U_1: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">U_1</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;U_2: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">U_2</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1">## Finding the projection of B onto C(A):</span>

<span class="n">B_cap</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">U_1</span><span class="p">)</span><span class="o">*</span><span class="n">U_1</span> <span class="o">+</span> <span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">U_2</span><span class="p">)</span><span class="o">*</span><span class="n">U_2</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;B_cap: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>U_1: 
 [[0.40824829]
 [0.81649658]
 [0.40824829]] 

U_2: 
 [[ 0.57735027]
 [-0.57735027]
 [ 0.57735027]] 

B_cap: 
 [[ 0.31532663]
 [-0.91834171]
 [ 0.72864322]] 
</pre></div>
</div>
</div>
</div>
<p>In the above code cell, <span class="math notranslate nohighlight">\(\hat{B}\)</span>  represents the orthogonal projection of <span class="math notranslate nohighlight">\(B\)</span> onto <span class="math notranslate nohighlight">\(C(A)\)</span>.</p>
<p>Now, we need to solve the system:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\left[\begin{array}{rrr} 1 &amp; 2 &amp; 2 \\ 2 &amp; 1 &amp; 4 \\ 1 &amp; 2 &amp; 2  \end{array}\right] \hat{X} = \left[\begin{array}{r} 1.5 \\1 \\ 1.5 \end{array}\right]  
\end{equation}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_aug</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">1.5</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">1.5</span><span class="p">]])</span>
<span class="n">A_aug_red</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">FullRowReduction</span><span class="p">(</span><span class="n">A_aug</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A_aug_red: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">A_aug_red</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A_aug_red: 
 [[1.         0.         2.         0.16666667]
 [0.         1.         0.         0.66666667]
 [0.         0.         0.         0.        ]] 
</pre></div>
</div>
</div>
</div>
<p>Let</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\hat{X} = \left[\begin{array}{r} a \\b \\ c\end{array}\right]  
\end{equation}
\end{split}\]</div>
<p>We can see that <span class="math notranslate nohighlight">\(c\)</span> is a free variable. So, let <span class="math notranslate nohighlight">\(c=t\)</span> where <span class="math notranslate nohighlight">\(t\)</span> is a scalar. Then, <span class="math notranslate nohighlight">\(b = 0.67\)</span>, <span class="math notranslate nohighlight">\(a = 0.167 - 2t\)</span>.</p>
<p>So,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\hat{X} = \left[\begin{array}{r} 0.167-2t \\ 0.67 \\ t\end{array}\right]    
= \left[\begin{array}{r} 0.167 \\ 0.67 \\ 0\end{array}\right]  +t\left[\begin{array}{r} -2 \\ 0 \\ 1\end{array}\right]
\end{equation}
\end{split}\]</div>
<p>Hence, we can conclude that there are infintely many solutions for the system <span class="math notranslate nohighlight">\( A\hat{X} = \hat{B}\)</span>. One possible solution is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\hat{X} = \left[\begin{array}{r} 0.167 \\ 0.67 \\ 0\end{array}\right]    
\end{equation}
\end{split}\]</div>
<p>when <span class="math notranslate nohighlight">\(t=0\)</span>.</p>
<p><strong>Exercise 9:</strong> Can you use <span class="math notranslate nohighlight">\(QR\)</span> factorization in <strong>Exercise 7</strong> to solve the normal equation ? Explain.</p>
<p><strong>Solution:</strong></p>
<p>No, we cannot use <span class="math notranslate nohighlight">\(QR\)</span> factorization in <strong>Exercise 7</strong> to solve the normal equation because <span class="math notranslate nohighlight">\(QR\)</span> factorization exists only if the columns of the matrix <span class="math notranslate nohighlight">\(A\)</span> are linearly independent.  In <strong>Exercise 7</strong>, we saw that column three was a multiple of the first column.  Therefore, the columns of the matrix <span class="math notranslate nohighlight">\(A\)</span> were linearly dependent.</p>
</div>
<div class="section" id="projections">
<h2>Projections<a class="headerlink" href="#projections" title="Permalink to this headline">¶</a></h2>
<p><strong>Exercise 1:</strong> Let <span class="math notranslate nohighlight">\(\mathcal{U}\)</span> be the subspace of <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span> spanned by <span class="math notranslate nohighlight">\(\{X_1,X_2\}\)</span> where <span class="math notranslate nohighlight">\(X_1\)</span> and <span class="math notranslate nohighlight">\(X_2\)</span> are given below. Find a matrix <span class="math notranslate nohighlight">\(P\)</span> such that <span class="math notranslate nohighlight">\(PX = B\)</span> where <span class="math notranslate nohighlight">\(B\)</span> is the orthogonal projection of <span class="math notranslate nohighlight">\(X\)</span> onto <span class="math notranslate nohighlight">\(\mathcal{U}\)</span>. Verify your answer.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X_1 = \left[\begin{array}{r} 1 \\ 1 \\ 2 \end{array}\right]  \hspace{1cm}
X_2 = \left[\begin{array}{r} 2 \\ 0 \\ -1 \end{array}\right]
\end{equation}
\end{split}\]</div>
<p><strong>Solution:</strong></p>
<p>Let us first check if <span class="math notranslate nohighlight">\(\{X_1,X_2\}\)</span> is an orthonormal basis for the subspace <span class="math notranslate nohighlight">\(\mathcal{U}\)</span>.</p>
<p><span class="math notranslate nohighlight">\(X_1.X_2 = 0\)</span> and <span class="math notranslate nohighlight">\(||X_1|| = \sqrt{6}\)</span> and <span class="math notranslate nohighlight">\(||X_2|| = \sqrt{5}\)</span>.</p>
<p>This means that <span class="math notranslate nohighlight">\(\{X_1,X_2\}\)</span> is an orthogonal basis for <span class="math notranslate nohighlight">\(\mathcal{U}\)</span> but not an orthonormal basis. We scale <span class="math notranslate nohighlight">\(X_1\)</span>, <span class="math notranslate nohighlight">\(X_2\)</span> to unit length and rename them as <span class="math notranslate nohighlight">\(\{U_1\)</span>, <span class="math notranslate nohighlight">\(U_2\}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">X_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">U_1</span> <span class="o">=</span> <span class="n">X_1</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">U_2</span> <span class="o">=</span> <span class="n">X_2</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;U_1: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">U_1</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;U_2: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">U_2</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>U_1: 
 [[0.40824829]
 [0.40824829]
 [0.81649658]] 

U_2: 
 [[ 0.89442719]
 [ 0.        ]
 [-0.4472136 ]] 
</pre></div>
</div>
</div>
</div>
<p>With the orthonormal basis, we can find the projection matrix <span class="math notranslate nohighlight">\(P\)</span> by using the formula <span class="math notranslate nohighlight">\(P =  U_1U_1^T + U_2U_2^T\)</span>, and then check that <span class="math notranslate nohighlight">\(P^2=P\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U_1_T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">U_1</span><span class="p">)</span>
<span class="n">U_2_T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">U_2</span><span class="p">)</span>

<span class="n">P</span> <span class="o">=</span> <span class="n">U_1</span><span class="nd">@U_1_T</span> <span class="o">+</span> <span class="n">U_2</span><span class="nd">@U_2_T</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;P: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">P_sqr</span> <span class="o">=</span> <span class="n">P</span><span class="nd">@P</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;P_sqr: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">P_sqr</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>P: 
 [[ 0.96666667  0.16666667 -0.06666667]
 [ 0.16666667  0.16666667  0.33333333]
 [-0.06666667  0.33333333  0.86666667]] 

P_sqr: 
 [[ 0.96666667  0.16666667 -0.06666667]
 [ 0.16666667  0.16666667  0.33333333]
 [-0.06666667  0.33333333  0.86666667]] 
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 2:</strong> Let <span class="math notranslate nohighlight">\(\mathcal{W}\)</span> be a subspace of <span class="math notranslate nohighlight">\(\mathbb{R}^4\)</span> with <span class="math notranslate nohighlight">\(\dim{\mathcal{W}}=2\)</span>. What will be the dimensions of a matrix <span class="math notranslate nohighlight">\(P\)</span> that projects vectors orthogonally onto <span class="math notranslate nohighlight">\(\mathcal{W}\)</span>?  Will the dimensions of <span class="math notranslate nohighlight">\(P\)</span> change if <span class="math notranslate nohighlight">\(\dim{\mathcal{W}}=3\)</span>?</p>
<p><strong>Solution:</strong></p>
<p>Given that <span class="math notranslate nohighlight">\(\dim{\mathcal{W}}=2\)</span>, we know there will an orthonormal basis for <span class="math notranslate nohighlight">\(\mathcal{W}\)</span> that contains two vectors. Let us call these vectors <span class="math notranslate nohighlight">\(U_1\)</span> and <span class="math notranslate nohighlight">\(U_2\)</span>.  The projection matrix is <span class="math notranslate nohighlight">\(P = U_1U_1^T + U_2U_2^T\)</span>.</p>
<p>Since <span class="math notranslate nohighlight">\(U_1\)</span> and <span class="math notranslate nohighlight">\(U_2\)</span> are in <span class="math notranslate nohighlight">\(\mathbb{R}^4\)</span>, they are <span class="math notranslate nohighlight">\(4 \times 1\)</span> vectors.  As a result, <span class="math notranslate nohighlight">\(U_1U_1^T\)</span> and <span class="math notranslate nohighlight">\(U_2U_2^T\)</span> are <span class="math notranslate nohighlight">\(4 \times 4\)</span> matrices.  Therefore, the projection matrix <span class="math notranslate nohighlight">\(P\)</span> is a <span class="math notranslate nohighlight">\(4 \times 4 \)</span> matrix.</p>
<p>The dimensions of <span class="math notranslate nohighlight">\(P\)</span> will not change if there were three basis vectors in <span class="math notranslate nohighlight">\(\mathcal{W}\)</span>. The projection matrix <span class="math notranslate nohighlight">\(P = U_1U_1^T + U_2U_2^T + U_3U_3^T\)</span> will still be a <span class="math notranslate nohighlight">\(4 \times 4\)</span> matrix.</p>
<p><strong>Exercise 3:</strong></p>
<p><span class="math notranslate nohighlight">\((a)\)</span> Let <span class="math notranslate nohighlight">\(\mathcal{U} = \{[x_1\, x_2\, x_3, x_4]^T : x_1 + 3x_2 + x_3 -2x_4 = 0 \}\)</span>. Find the matrix <span class="math notranslate nohighlight">\(P\)</span> that projects vectors orthogonally onto <span class="math notranslate nohighlight">\(\mathcal{U}\)</span>.</p>
<p><span class="math notranslate nohighlight">\((b)\)</span> Demonstrate that your matrix is a projection matrix by showing that <span class="math notranslate nohighlight">\(P^2 = P\)</span>.</p>
<p><strong>Solution;</strong></p>
<p>We begin by finding a basis for <span class="math notranslate nohighlight">\(\mathcal{U}\)</span>.  We treat <span class="math notranslate nohighlight">\(x_2\)</span>, <span class="math notranslate nohighlight">\(x_3\)</span>, and <span class="math notranslate nohighlight">\(x_4\)</span> as free variables and let <span class="math notranslate nohighlight">\(x_2 = r\)</span>, <span class="math notranslate nohighlight">\(x_3 = s\)</span>, and <span class="math notranslate nohighlight">\(x_4 = t\)</span>.  Then for any given point on the plane, <span class="math notranslate nohighlight">\(x_1 = -3r - s + 2t\)</span> and</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\left[ \begin{array}{r} x_1 \\ x_2 \\ x_3 \\ x_4 \end{array}\right] = 
r\left[ \begin{array}{r} -3 \\ 1 \\ 0 \\ 0 \end{array}\right] + s\left[ \begin{array}{r} -1 \\ 0 \\ 1 \\ 0 \end{array}\right] + t\left[ \begin{array}{r} 2 \\ 0 \\ 0 \\ 1 \end{array}\right]
\end{equation}
\end{split}\]</div>
<p>A basis for <span class="math notranslate nohighlight">\(\mathcal{U}\)</span> is <span class="math notranslate nohighlight">\(\{V_1,V_2,V_3\}\)</span>, where</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
V_1 = \left[\begin{array}{r} -3 \\ 1 \\ 0 \\ 0 \end{array}\right]  \hspace{1cm}
V_2 = \left[\begin{array}{r} -1 \\ 0 \\ 1 \\ 0 \end{array}\right]  \hspace{1cm}
V_3 = \left[\begin{array}{r} 2 \\ 0 \\ 0 \\ 1 \end{array}\right]
\end{equation}
\end{split}\]</div>
<p>If we form a matrix <span class="math notranslate nohighlight">\(A\)</span> that has these vectors as its columns, then <span class="math notranslate nohighlight">\(P = A(A^TA)^{-1}A^T\)</span> is the matrix that projects vectors orthogonally onto <span class="math notranslate nohighlight">\(\mathcal{U}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">Inverse</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@A</span><span class="p">)</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="nd">@B@A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 0.93333333 -0.2        -0.06666667  0.13333333]
 [-0.2         0.4        -0.2         0.4       ]
 [-0.06666667 -0.2         0.93333333  0.13333333]
 [ 0.13333333  0.4         0.13333333  0.73333333]]
</pre></div>
</div>
</div>
</div>
<p>We show that <span class="math notranslate nohighlight">\(P^2 = P\)</span> by calculating <span class="math notranslate nohighlight">\(P^2-P\)</span> and verifying that it is the zero matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">P</span><span class="nd">@P</span> <span class="o">-</span> <span class="n">P</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-0.  0. -0. -0.]
 [ 0.  0. -0.  0.]
 [ 0. -0.  0. -0.]
 [-0.  0. -0.  0.]]
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 4:</strong></p>
<p>(<span class="math notranslate nohighlight">\(a\)</span>) Let <span class="math notranslate nohighlight">\(\mathcal{V} = \{[x_1\, x_2\, x_3]^T : x_1 + x_2 + x_3  = 0 \}\)</span>.  Find the matrix <span class="math notranslate nohighlight">\(P\)</span> that projects vectors orthogonally onto <span class="math notranslate nohighlight">\(\mathcal{V}\)</span> by two different methods.</p>
<p><span class="math notranslate nohighlight">\((b)\)</span> Demonstrate that your matrix is a projection matrix by showing that <span class="math notranslate nohighlight">\(P^2 = P\)</span>.</p>
<p><strong>Solution</strong></p>
<p>We begin by finding a basis for <span class="math notranslate nohighlight">\(\mathcal{V}\)</span>.  We treat <span class="math notranslate nohighlight">\(x_2\)</span> and <span class="math notranslate nohighlight">\(x_3\)</span> like free variables and find <span class="math notranslate nohighlight">\(x_1\)</span> in terms of <span class="math notranslate nohighlight">\(x_3\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span>.  If <span class="math notranslate nohighlight">\(x_3 = c\)</span> and <span class="math notranslate nohighlight">\(x_2 =b\)</span>, then <span class="math notranslate nohighlight">\(x_1 = -b-c\)</span> and</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
 \left[\begin{array}{r} x_1 \\ x_2 \\ x_3 \end{array}\right] = \left[\begin{array}{r} -b-c \\ b \\ c \end{array}\right] = b\left[\begin{array}{r} -1 \\ 1 \\ 0\end{array}\right] + c\left[\begin{array}{r} -1 \\ 0 \\ 1 \end{array}\right]
\end{equation}
\end{split}\]</div>
<p>A basis for <span class="math notranslate nohighlight">\(\mathcal{V}\)</span> is <span class="math notranslate nohighlight">\(\{V_1,V_2\}\)</span>, where</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
V_1 = \left[\begin{array}{r} -1 \\ 1 \\ 0 \end{array}\right]  \hspace{1cm}
V_2 = \left[\begin{array}{r} -1 \\ 0 \\ 1 \end{array}\right]
\end{equation}
\end{split}\]</div>
<p><strong>Method 1</strong></p>
<p>With a basis for <span class="math notranslate nohighlight">\(V\)</span>, we can get the projection matrix directly using the formula: <span class="math notranslate nohighlight">\(P = A(A^TA)^{-1}A^T\)</span>
where <span class="math notranslate nohighlight">\(A\)</span> is the matrix with vectors <span class="math notranslate nohighlight">\(V_1\)</span> and <span class="math notranslate nohighlight">\(V_2\)</span> as its columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">V_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">V_1</span><span class="p">,</span><span class="n">V_2</span><span class="p">))</span>

<span class="n">A_trans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">A_trans</span><span class="nd">@A</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">Inverse</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="nd">@D@A_trans</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;P: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>P: 
 [[ 0.66666667 -0.33333333 -0.33333333]
 [-0.33333333  0.66666667 -0.33333333]
 [-0.33333333 -0.33333333  0.66666667]] 
</pre></div>
</div>
</div>
</div>
<p><strong>Method 2</strong></p>
<p>Alternatively, we can generate an orthonormal basis <span class="math notranslate nohighlight">\(\{U_1,U_2\}\)</span> for <span class="math notranslate nohighlight">\(\mathcal{V}\)</span> using Gram-Schimdt orthogonalization, and then use the formula <span class="math notranslate nohighlight">\(P =  U_1U_1^T + U_2U_2^T\)</span>  for projection matrix .</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Let W_1, W_2 be the orthogonal basis for V:</span>

<span class="n">W_1</span> <span class="o">=</span> <span class="n">V_1</span>
<span class="n">W_2</span> <span class="o">=</span> <span class="n">V_2</span> <span class="o">-</span> <span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">V_2</span><span class="p">,</span> <span class="n">W_1</span><span class="p">)</span><span class="o">/</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">W_1</span><span class="p">,</span><span class="n">W_1</span><span class="p">))</span><span class="o">*</span><span class="n">W_1</span>  


<span class="n">U_1</span> <span class="o">=</span> <span class="n">W_1</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">W_1</span><span class="p">,</span><span class="n">W_1</span><span class="p">))</span>
<span class="n">U_2</span> <span class="o">=</span> <span class="n">W_2</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lag</span><span class="o">.</span><span class="n">DotProduct</span><span class="p">(</span><span class="n">W_2</span><span class="p">,</span><span class="n">W_2</span><span class="p">))</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;U_1: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">U_1</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;U_2; </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">U_2</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">U_1_trans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">U_1</span><span class="p">)</span>
<span class="n">U_2_trans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">U_2</span><span class="p">)</span>


<span class="n">P</span> <span class="o">=</span> <span class="n">U_1</span><span class="nd">@U_1_trans</span> <span class="o">+</span> <span class="n">U_2</span><span class="nd">@U_2_trans</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;P: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>U_1: 
 [[-0.70710678]
 [ 0.70710678]
 [ 0.        ]] 

U_2; 
 [[-0.40824829]
 [-0.40824829]
 [ 0.81649658]] 

P: 
 [[ 0.66666667 -0.33333333 -0.33333333]
 [-0.33333333  0.66666667 -0.33333333]
 [-0.33333333 -0.33333333  0.66666667]] 
</pre></div>
</div>
</div>
</div>
<p>Both methods generate the same matrix <span class="math notranslate nohighlight">\(P\)</span>.  Finally, we check that the matrix <span class="math notranslate nohighlight">\(P\)</span> is actually a projection matrix by verifying that <span class="math notranslate nohighlight">\(P^2 = P\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P_sqr</span> <span class="o">=</span> <span class="n">P</span><span class="nd">@P</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;P_sqr: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">P_sqr</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>P_sqr: 
 [[ 0.66666667 -0.33333333 -0.33333333]
 [-0.33333333  0.66666667 -0.33333333]
 [-0.33333333 -0.33333333  0.66666667]] 
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 5:</strong></p>
<p><span class="math notranslate nohighlight">\((a)\)</span> Find the matrix <span class="math notranslate nohighlight">\(P_1\)</span> that projects orthogonally onto the subspace spanned by <span class="math notranslate nohighlight">\(\begin{equation}
\left\{ \left[ \begin{array}{r} 2 \\ 1 \end{array} \right]\right\}
\end{equation}\)</span>.</p>
<p><span class="math notranslate nohighlight">\((b)\)</span> Find the matrix <span class="math notranslate nohighlight">\(P_2\)</span> that projects orthogonally onto the subspace spanned by <span class="math notranslate nohighlight">\(\begin{equation}
\left\{ \left[ \begin{array}{r} -1 \\ 4 \end{array} \right]\right\}
\end{equation}\)</span>.</p>
<p><span class="math notranslate nohighlight">\((c)\)</span> Is the product <span class="math notranslate nohighlight">\(P_1P_2\)</span> also an orthogonal projection?</p>
<p><strong>Solution:</strong></p>
<p>Let <span class="math notranslate nohighlight">\(A = \begin{equation}  \left[ \begin{array}{r} 2 \\ 1 \end{array} \right] \end{equation}\)</span>.  <span class="math notranslate nohighlight">\(P_1 = A(A^TA)^{-1}A^T\)</span> is the matrix that projects vectors orthogonally onto the subspace spanned by <span class="math notranslate nohighlight">\(\begin{equation} \left\{ \left[ \begin{array}{r} 2 \\ 1 \end{array} \right]\right\} \end{equation}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">Inverse</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@A</span><span class="p">)</span>
<span class="n">P_1</span> <span class="o">=</span> <span class="n">A</span><span class="nd">@B@A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">P_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.8 0.4]
 [0.4 0.2]]
</pre></div>
</div>
</div>
</div>
<p>Let <span class="math notranslate nohighlight">\(C = \begin{equation}  \left[ \begin{array}{r} -1 \\ 4 \end{array} \right] \end{equation}\)</span>.  Then <span class="math notranslate nohighlight">\(P_2 = C(C^TC)^{-1}C^T\)</span> is the matrix that projects vectors  orthogonally onto the subspace spanned by <span class="math notranslate nohighlight">\(\begin{equation} \left\{ \left[ \begin{array}{r} -1 \\ 4 \end{array} \right]\right\} \end{equation}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">]])</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">lag</span><span class="o">.</span><span class="n">Inverse</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@C</span><span class="p">)</span>
<span class="n">P_2</span> <span class="o">=</span> <span class="n">C</span><span class="nd">@D@C</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">P_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 0.05882353 -0.23529412]
 [-0.23529412  0.94117647]]
</pre></div>
</div>
</div>
</div>
<p>We check if <span class="math notranslate nohighlight">\((P_1P_2)^2 = P_1P_2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">P_1</span><span class="nd">@P_2</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">((</span><span class="n">P_1</span><span class="nd">@P_2</span><span class="p">)</span><span class="o">@</span><span class="p">(</span><span class="n">P_1</span><span class="nd">@P_2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-0.04705882  0.18823529]
 [-0.02352941  0.09411765]] 

[[-0.00221453  0.00885813]
 [-0.00110727  0.00442907]]
</pre></div>
</div>
</div>
</div>
<p>We can see that <span class="math notranslate nohighlight">\((P_1P_2)^2 \neq P_1P_2\)</span>, so <span class="math notranslate nohighlight">\(P_1P_2\)</span> is not a projection.</p>
<p><strong>Exercise 6:</strong> Let <span class="math notranslate nohighlight">\(\mathcal{U}\)</span> be the subspace spanned by <span class="math notranslate nohighlight">\(\begin{equation} \left\{ \left[ \begin{array}{r} 0 \\ 1 \\ 0 \end{array} \right]\right\} \end{equation}\)</span> and <span class="math notranslate nohighlight">\(\mathcal{W}\)</span> be the subspace spanned by <span class="math notranslate nohighlight">\(\begin{equation} \left\{ \left[ \begin{array}{r} 2 \\ 1 \\ 1 \end{array} \right] \hspace{0.1cm} , \hspace{0.1cm} \left[ \begin{array}{r} 0 \\ 1 \\ 1 \end{array} \right]\right\} \end{equation}\)</span></p>
<p><span class="math notranslate nohighlight">\((a)\)</span> Find a matrix <span class="math notranslate nohighlight">\(P\)</span> so that <span class="math notranslate nohighlight">\(PX\)</span> is the projection of <span class="math notranslate nohighlight">\(X\)</span> onto <span class="math notranslate nohighlight">\(\mathcal{U}\)</span> along <span class="math notranslate nohighlight">\(\mathcal{W}\)</span>.</p>
<p><span class="math notranslate nohighlight">\((b)\)</span> Check that <span class="math notranslate nohighlight">\(P^2 = P\)</span></p>
<p><span class="math notranslate nohighlight">\((c)\)</span> Check that <span class="math notranslate nohighlight">\(PX\)</span> is in <span class="math notranslate nohighlight">\(\mathcal{U}\)</span> for any <span class="math notranslate nohighlight">\(X \in \mathbb{R}^3\)</span>.</p>
<p><span class="math notranslate nohighlight">\((d)\)</span> Check that <span class="math notranslate nohighlight">\(PW = 0\)</span> for any <span class="math notranslate nohighlight">\(W \in \mathcal{W}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here.</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "bvanderlei/jupyter-guide-to-linear-algebra",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="Linear_Transformations_Solutions.html" title="previous page">Linear Transformations</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Ben Vanderlei<br/>
        
          <div class="extra_footer">
            <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Jupyter Guide to Linear Algebra</span> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.
          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>