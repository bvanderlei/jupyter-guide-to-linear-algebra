
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Applications of Linear Transformations &#8212; Jupyter Guide to Linear Algebra</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.c441f2ba0852f4cabcb80105e3a46ae6.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script src="_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Inner Products" href="Inner_Products.html" />
    <link rel="prev" title="Transformations in a Plane" href="Planar_Transformations.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/reflection_logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Jupyter Guide to Linear Algebra</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Welcome to the Jupyter Guide to Linear Algebra
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="Jupyter_Introduction.html">
   Introduction to Jupyter
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="Python_Introduction.html">
     Introduction to Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Numpy_Introduction.html">
     Introduction to NumPy and Matplotlib
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="Linear_Systems.html">
   Linear Systems
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="Gaussian_Elimination.html">
     Gaussian Elimination
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Matrix_Algebra.html">
     Matrix Algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Solving_Systems.html">
     Solving Systems using Elimination
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Inverse_Matrices.html">
     Inverse Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="LU_Factorization.html">
     LU Factorization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Applications.html">
     Applications of Linear Systems and Matrix Algebra
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="Vector_Spaces.html">
   Vector Spaces
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="General_Linear_Systems.html">
     General Linear Systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Linear_Combinations.html">
     Linear Combinations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Linear_Independence.html">
     Linear Independence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Bases.html">
     Bases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Vector_Space_Examples.html">
     Vector Space Examples
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Applications_VS.html">
     Applications of Vector Spaces
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="Linear_Transformations.html">
   Linear Transformations
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="Matrix_Representations.html">
     Matrix Representations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Planar_Transformations.html">
     Transformations in a Plane
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Applications of Linear Transformations
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="Inner_Products.html">
   Inner Products
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="Orthogonalization.html">
     Orthogonalization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="QR_Factorization.html">
     QR Factorization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Orthogonal_Subspaces.html">
     Orthogonal Subspaces
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Least_Squares_Solutions.html">
     Least Squares Solutions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Projections.html">
     Projections
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Applications_IP.html">
     Applications of Inner Products
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="Eigenvalues.html">
   Eigenvalues
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="Diagonalization.html">
     Diagonalization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Approximating_Eigenvalues.html">
     Approximating Eigenvalues
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Applications_EV.html">
     Applications of Eigenvalues and Eigenvectors
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="Solutions.html">
   Solutions
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="Introduction_Solutions.html">
     Introduction to Jupyter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Linear_Systems_Solutions.html">
     Linear Systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Vector_Spaces_Solutions.html">
     Vector Spaces
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Linear_Transformations_Solutions.html">
     Linear Transformations
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Applications_LT.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/bvanderlei/jupyter-guide-to-linear-algebra/main?urlpath=tree/Applications_LT.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#computer-graphics">
   Computer graphics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#translation">
     Translation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercises">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#discrete-dynamical-systems">
   Discrete dynamical systems
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#infectious-disease-model">
     Infectious Disease Model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#navigating-webpages">
     Navigating webpages
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="applications-of-linear-transformations">
<h1>Applications of Linear Transformations<a class="headerlink" href="#applications-of-linear-transformations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="computer-graphics">
<h2>Computer graphics<a class="headerlink" href="#computer-graphics" title="Permalink to this headline">¶</a></h2>
<p>Computer graphics essentially consist of a large number of basic geometric shapes such as triangles or quadrilaterals, defined by their vertexes (corners).  The ability to manipulate these shapes efficiently is a fundamental necessity in the field of computer graphics.  Linear transformations can be used to generate a complex shapes from a basic shapes through effects such as shearing and reflection, and can also be used to rotate and translate shapes in order to create a sequence of images needed for an animated scene.</p>
<p>The software responsible for rendering three-dimensional scenes in modern video games must process the coordinates of millions of vertexes in each frame of animation.  Typical hardware used for running the software will be able to generate around 60 frames per second.  In addition to the placement of vertexes in a scene, there are other computations required, such as those to provide color and shading, and then to project the three-dimensional scene onto the two-dimensional screen.  In this context, the efficiency of the algorithms, software, and hardware all play a major role in the quality of the end result.</p>
<p>The use of matrix multiplication to manipulate coordinates for computer graphics has two primary advantages.  Matrix representations can be used to merge multiple transformations together into a single transformation.  For example, instead of applying a rotation followed by a scaling transformation, the two operations can easily be merged into a single operation by multiplying the associated matrices as we did earlier.  The other advantage to organizing the calculations into matrix multiplications is that dedicated hardware (graphics processing units) is designed specifically to handle these calculations in large numbers.</p>
<p>The construction of matrices to carry out rotations, reflections, and shears, has already been demonstrated in <a class="reference internal" href="Planar_Transformations.html"><span class="doc std std-doc">Planar Transformations</span></a>.  Here we show how to use matrix multiplication to carry out a translation, which is not a linear transformation.</p>
<div class="section" id="translation">
<h3>Translation<a class="headerlink" href="#translation" title="Permalink to this headline">¶</a></h3>
<p>A <strong>translation</strong> is a transformation that moves all points an equal amount in the same direction.  Shown below is an example where all points are shifted (translated) three units to the right, and one unit up by a transformation <span class="math notranslate nohighlight">\(T:\mathbb{R}^2 \to \mathbb{R}^2\)</span>.  In the plot, we show several points which define a shape, and their corresponding images under the translation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline  
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span>

<span class="c1">## Compute translation by adding 3 to x coordinates and 1 to y coordinates</span>
<span class="n">x_translated</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y_translated</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">x_translated</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">3</span>
    <span class="n">y_translated</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the figure and axes objects</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># Plot the points.</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_translated</span><span class="p">,</span><span class="n">y_translated</span><span class="p">,</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>

<span class="c1"># Connect the points by lines</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_translated</span><span class="p">,</span><span class="n">y_translated</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

<span class="c1"># Edit some settings </span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Translation&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Applications_LT_4_0.png" src="_images/Applications_LT_4_0.png" />
</div>
</div>
<p>Translation of coordinates is useful in computer graphics, but it is not a linear transformation.  In order to see why, we write a formula for the image of a vector <span class="math notranslate nohighlight">\(X\)</span>, and then verify that <span class="math notranslate nohighlight">\(T(X+Y) \neq T(X)+T(Y)\)</span> for arbitrary vectors <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
T(X) = X + \left[ \begin{array}{r} 3 \\ 1 \end{array} \right]
\end{equation}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
T(X+Y) = (X + Y) + \left[ \begin{array}{r} 3 \\ 1 \end{array} \right]
\end{equation}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
T(X) + T(Y) = X + \left[ \begin{array}{r} 3 \\ 1 \end{array} \right] + Y + \left[ \begin{array}{r} 3 \\ 1 \end{array} \right]
= (X + Y) + \left[ \begin{array}{r} 6 \\ 2 \end{array} \right]
\end{equation}
\end{split}\]</div>
<p>The fact that <span class="math notranslate nohighlight">\(T\)</span> is not linear implies that this transformation cannot be represented as a matrix multiplication in its current state.</p>
<p>Since the use of translations are necessary, a standard method has been developed to incorporate matrix multiplication and the associated advantages.  The method requires that we view <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span> as a plane within <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span>.  We can then construct a linear transformation <span class="math notranslate nohighlight">\(L:\mathbb{R}^3\to\mathbb{R}^3\)</span> which will have the <em>effect of the translation</em> within that plane.  We demonstrate the details for the transformation defined above.</p>
<p>First, we associate the coordinates <span class="math notranslate nohighlight">\((x_1,x_2)\)</span> of a point in <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span> with the coordinates <span class="math notranslate nohighlight">\((x_1,x_2,1)\)</span> of a point in <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span> in the plane <span class="math notranslate nohighlight">\(x_3=1\)</span>.  These new coordinates are known as <em>homogeneous coordinates</em>.  We can then create a linear transformation <span class="math notranslate nohighlight">\(L:\mathbb{R}^3\to\mathbb{R}^3\)</span> that represents a shear that is parallel to the <span class="math notranslate nohighlight">\(x_1x_2\)</span>-plane, and in the direction of the desired translation.  The effect of <span class="math notranslate nohighlight">\(L\)</span> on points in the plane <span class="math notranslate nohighlight">\(x_3=1\)</span> is a translation within the <span class="math notranslate nohighlight">\(x_3=1\)</span> plane.  We define <span class="math notranslate nohighlight">\(L(X)=AX\)</span>, where <span class="math notranslate nohighlight">\(A\)</span> is the following matrix.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
A = \left[ \begin{array}{rrr} 1 &amp; 0 &amp; 3 \\ 0 &amp; 1 &amp; 1 \\ 0 &amp; 0 &amp; 1 \end{array} \right]
\end{equation}
\end{split}\]</div>
<p>Recall that the columns of <span class="math notranslate nohighlight">\(A\)</span> are the images of the standard basis vectors <span class="math notranslate nohighlight">\(\{E_1, E_2, E_3\}\)</span>.  In this case <span class="math notranslate nohighlight">\(E_1\)</span> and <span class="math notranslate nohighlight">\(E_2\)</span> are unchanged, and <span class="math notranslate nohighlight">\(E_3\)</span> is sheared in the desired direction.  We observe that <span class="math notranslate nohighlight">\(L\)</span> has the intended effect.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
L(X) = AX = \left[ \begin{array}{rrr} 1 &amp; 0 &amp; 3 \\ 0 &amp; 1 &amp; 1 \\ 0 &amp; 0 &amp; 1 \end{array} \right]
\left[ \begin{array}{r} x_1 \\ x_2 \\ 1 \end{array} \right] = 
\left[ \begin{array}{c} x_1+3 \\ x_2+1 \\ 1 \end{array} \right]
\end{equation}
\end{split}\]</div>
<p>Finally, we associate with <span class="math notranslate nohighlight">\(L(X)\)</span> the point in <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span> that has coordinates <span class="math notranslate nohighlight">\((x_1+3, x_2+1)\)</span>.</p>
<p>Let’s have a look at the revised calculation with NumPy, that now makes use of the matrix multiplication.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ones</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Ones</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1. 1. 1. 1. 1. 1. 1.]]
[0 0 1 1 2 2 0]
[[0 0 1 1 2 2 0]
 [0 3 3 1 1 0 0]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Form a matrix of coordinates with rows x, y, 1</span>
<span class="n">Ones</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">Ones</span><span class="p">))</span>

<span class="c1"># Define the matrix for the transfomation L</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>

<span class="c1">## Compute translation by matrix multiplication</span>
<span class="n">coords_translated</span> <span class="o">=</span> <span class="n">A</span><span class="nd">@coords</span>

<span class="c1">## Slice off the first and second rows.  These are the coords of the translated points</span>
<span class="n">x_translated</span> <span class="o">=</span> <span class="n">coords_translated</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
<span class="n">y_translated</span> <span class="o">=</span> <span class="n">coords_translated</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the figure and axes objects</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># Plot the points.</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_translated</span><span class="p">,</span><span class="n">y_translated</span><span class="p">,</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>

<span class="c1"># Connect the points by lines</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_translated</span><span class="p">,</span><span class="n">y_translated</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

<span class="c1"># Edit some settings </span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Translation&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Applications_LT_9_0.png" src="_images/Applications_LT_9_0.png" />
</div>
</div>
<p>If we look closely at the computation, we realize that this way of computing the coordinates of the translated shape actually requires <em>more operations</em> than the first attempt where we stepped through the array and manipulated the coordinates directly.  The important point to remember however is that the ability to represent the translation as a matrix multiplication means that we can merge it with another operation, such as rotation, in order to carry out both operations by multiplying by a single matrix.</p>
<p>Translations of shapes in three dimensions can be done in a similar way by associating each set of coordinate <span class="math notranslate nohighlight">\((x_1, x_2, x_3)\)</span> in <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span> with the point <span class="math notranslate nohighlight">\((x_1, x_2, x_3, 1)\)</span> in <span class="math notranslate nohighlight">\(\mathbb{R}^4\)</span>.</p>
</div>
<div class="section" id="exercises">
<h3>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Find a single matrix that represents a transformation that has the effect of a reflection about the line <span class="math notranslate nohighlight">\(x_1=x_2\)</span> followed by a shift four units to the left.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here.</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Apply the transformation to the shape defined by <span class="math notranslate nohighlight">\(\texttt{coords}\)</span> and plot the results.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here.</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Find a single matrix that represents a rotation about the point <span class="math notranslate nohighlight">\((1,2)\)</span>.  (<em>Hint:  Make use of a translation to bring the center of rotation to <span class="math notranslate nohighlight">\((0,0)\)</span></em>.)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here.</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="discrete-dynamical-systems">
<h2>Discrete dynamical systems<a class="headerlink" href="#discrete-dynamical-systems" title="Permalink to this headline">¶</a></h2>
<p>As we saw in the previous chapter, it is often useful to describe a structure that has multiple components with a single vector.  If that structure is changing in time due to some process, it is typical to refer to the vector as a <strong>state vector</strong> since it describes the <em>state</em> of the structure at some particular time.  It is quite common to model such dynamic processes at discrete times and use linear transformations to model the evolution of the state vector from one time to the next.</p>
<p>Let’s suppose that we aim to describe sequence of vectors at times <span class="math notranslate nohighlight">\(t=0, 1, 2, 3,\)</span>… with state vectors <span class="math notranslate nohighlight">\(X_0\)</span>, <span class="math notranslate nohighlight">\(X_1\)</span>, <span class="math notranslate nohighlight">\(X_2\)</span>, <span class="math notranslate nohighlight">\(X_3\)</span>…. at those times.  We propose to calculate the state vector <span class="math notranslate nohighlight">\(X_t\)</span> based only on the previous state vector <span class="math notranslate nohighlight">\(X_{t-1}\)</span>.  If we model the transition from <span class="math notranslate nohighlight">\(X_{t-1}\)</span> to <span class="math notranslate nohighlight">\(X_t\)</span> with a linear transformation, then there is a matrix such that <span class="math notranslate nohighlight">\(X_t = AX_{t-1}\)</span>.  This sort of model is known as a <strong>discrete dynamical system</strong> and is used in many areas from economics to biology.</p>
<div class="section" id="infectious-disease-model">
<h3>Infectious Disease Model<a class="headerlink" href="#infectious-disease-model" title="Permalink to this headline">¶</a></h3>
<p>In this example we consider a basic model of an infectious disease that is spreading within a population.  A well known family of models for this scenario is known as the <span class="math notranslate nohighlight">\(SIR\)</span> models.  The acronym comes from a basic modeling assumption that the population is divided into three categories: Susceptible, Infectious, and Recovered.  As the disease, spreads a portion of the Susceptible individuals become Infectious, and a portion of Infectious individuals become Recovered.  We will consider a small variation in the model which assumes that a portion of Recovered individuals return to the Susceptible category.  This variation, known as an <span class="math notranslate nohighlight">\(SIRS\)</span> model, would be a more accurate description of a disease which can be contracted multiple times.</p>
<p>We suppose that the population is completely homogeneous in all regards, so that all individuals in a given category have the same probabilities to move to the next category.</p>
<p>To model real-world epidemics, it is necessary to estimate some parameters that specify how quickly individuals move among the categories.  These parameters will be important in making any predictions with the model.  For our demonstration, we will create an example.  Let us suppose that our state vectors describe the population at time intervals of 1 week, and that every week, 5% of the Susceptible population becomes Infectious, and 20% of the Infectious population becomes Recovered.  We also suppose that 15% of the Recovered population again becomes Susceptible every week.</p>
<p>If we let <span class="math notranslate nohighlight">\(s_t\)</span>, <span class="math notranslate nohighlight">\(i_t\)</span>, and <span class="math notranslate nohighlight">\(r_t\)</span> represent the percentage of the three categories of the population at time <span class="math notranslate nohighlight">\(t\)</span>, we can write equations based on the modeling assumptions that allows us to calculate the values based on <span class="math notranslate nohighlight">\(s_{t-1}\)</span>, <span class="math notranslate nohighlight">\(i_{t-1}\)</span>, and <span class="math notranslate nohighlight">\(r_{t-1}\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
s_t &amp; = &amp; 0.95s_{t-1} \hspace{2cm} + 0.15r_{t-1} \\
i_t &amp; = &amp; 0.05s_{t-1}  + 0.80i_{t-1} \\
r_t &amp; = &amp; \hspace{2cm} 0.20i_{t-1} + 0.85r_{t-1} 
\end{eqnarray}
\end{split}\]</div>
<p>Now we can define <span class="math notranslate nohighlight">\(X_t\)</span> as the vector with components <span class="math notranslate nohighlight">\(s_t\)</span>, <span class="math notranslate nohighlight">\(i_t\)</span>, and <span class="math notranslate nohighlight">\(r_t\)</span>, so that the equations can be written using matrix multiplication.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X_t = \left[ \begin{array}{r} s_t \\ i_t \\ r_t  \end{array}\right] =
\left[ \begin{array}{rrr} 0.95 &amp; 0 &amp; 0.15 \\ 0.05 &amp; 0.80 &amp; 0 \\ 0 &amp; 0.20 &amp; 0.85 \end{array}\right]
\left[ \begin{array}{r} s_{t-1} \\ i_{t-1} \\ r_{t-1}  \end{array}\right]=
AX_{t-1}
\end{equation}
\end{split}\]</div>
<p>The linear transformation <span class="math notranslate nohighlight">\(L:\mathbb{R}^3 \to \mathbb{R}^3\)</span> defined by this matrix multiplication maps the state of the
population at time <span class="math notranslate nohighlight">\(t-1\)</span>, to the state of the population at time <span class="math notranslate nohighlight">\(t\)</span>.  For an example let’s label the initial state vector <span class="math notranslate nohighlight">\(X_0\)</span>, and consider what happens if initially 5% of the population is infective, and the other 95% of the population is susceptible.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X_0 = \left[ \begin{array}{r} 0.95 \\ 0.05 \\ 0  \end{array}\right] 
\end{equation}
\end{split}\]</div>
<p>We compute <span class="math notranslate nohighlight">\(X_1 = AX_0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.95</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">],[</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.85</span><span class="p">]])</span>

<span class="c1">## X at time 0</span>
<span class="n">X_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.95</span><span class="p">],[</span><span class="mf">0.05</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>

<span class="c1">## Compute X at the next time</span>
<span class="n">X_1</span> <span class="o">=</span> <span class="n">A</span><span class="nd">@X_0</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.9025]
 [0.0875]
 [0.01  ]]
</pre></div>
</div>
</div>
</div>
<p>Applying the transformation again gives <span class="math notranslate nohighlight">\(X_2 = AX_1 = A^2X_0\)</span>, the state of the population at time <span class="math notranslate nohighlight">\(t=2\)</span>.  In general, <span class="math notranslate nohighlight">\(n\)</span> repeated applications of the transformation yield <span class="math notranslate nohighlight">\(X_n = A^nX_0\)</span>, the state of the population <span class="math notranslate nohighlight">\(n\)</span> weeks into the future.  Let’s compute <span class="math notranslate nohighlight">\(X_{50}\)</span> as an example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## X at time 0</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.95</span><span class="p">],[</span><span class="mf">0.05</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="nd">@X</span>
    
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.63157999]
 [0.15789071]
 [0.2105293 ]]
</pre></div>
</div>
</div>
</div>
<p>In such models attention is typically focused on the ultimate behavior of the state vector.  We want to know if the composition of the population reaches an equilibrium, or continues to change.  If it reaches an equilibrium, can we calculate it directly, instead of applying the matrix multiplication a large number of times?  We will address these questions in Chapter 5, when we learn more about computing <span class="math notranslate nohighlight">\(A^n\)</span> efficiently.</p>
</div>
<div class="section" id="navigating-webpages">
<h3>Navigating webpages<a class="headerlink" href="#navigating-webpages" title="Permalink to this headline">¶</a></h3>
<p>Browsing webpages can also be modeled using a discrete dynamical system.  In this model, the entries of the state vector <span class="math notranslate nohighlight">\(X_t\)</span>, represent the probability that the browser is on a particular page at time <span class="math notranslate nohighlight">\(t\)</span>.  Advancing in time represents the browser moving from one page to another.  Many pages contain links to other pages.  The model assumes that the browser is more likely to follow a link to a new page rather than navigating to a new unlinked page.  The goal is to build a linear transformation <span class="math notranslate nohighlight">\(L\)</span>, defined by a matrix multiplication, which maps the vector of probabilities at time <span class="math notranslate nohighlight">\(t-1\)</span> to the vector of probabilities at time <span class="math notranslate nohighlight">\(t\)</span> based on the link structure of the pages.  Such a model was the foundation of the PageRank algorithm, which is the basis of Google’s very successful search engine.</p>
<p>To build the required matrix <span class="math notranslate nohighlight">\(A\)</span>, the entries <span class="math notranslate nohighlight">\(a_{ij}\)</span> are set to the probability that the browser navigates to page <span class="math notranslate nohighlight">\(i\)</span> from page <span class="math notranslate nohighlight">\(j\)</span>.  For fixed column <span class="math notranslate nohighlight">\(j\)</span>, the entries represent a  probability distribution that describes location of the browser at the next step.  The entries in each column therefore must add to one.  Let’s make some additional assumptions to complete the model.</p>
<ul class="simple">
<li><p>The browser follows a link with probability 0.8.</p></li>
<li><p>All links on a page are equally likely to be followed.</p></li>
<li><p>A browser not following a link is equally likely to reach any new page at the next step.</p></li>
<li><p>The browser always changes pages at each step</p></li>
</ul>
<p>These assumptions completely define the matrix.  If we let <span class="math notranslate nohighlight">\(n\)</span> be the number of webpages in the model, <span class="math notranslate nohighlight">\(A\)</span> will be an <span class="math notranslate nohighlight">\(n\times n\)</span> matrix with zeros on its main diagonal due to the last assumption.  If we focus on a particular page <span class="math notranslate nohighlight">\(j\)</span>, There are a total of <span class="math notranslate nohighlight">\(n-1\)</span> nonzero entries since <span class="math notranslate nohighlight">\(a_{jj} = 0\)</span>.  If page <span class="math notranslate nohighlight">\(j\)</span> has links to <span class="math notranslate nohighlight">\(k\)</span> different pages, then <span class="math notranslate nohighlight">\(a_{ij} = 0.8/k + 0.2/(n-1)\)</span> if <span class="math notranslate nohighlight">\(i\)</span> is the index of one of the link linked pages, and <span class="math notranslate nohighlight">\(a_{ij} = 0.2/(n-1)\)</span> if <span class="math notranslate nohighlight">\(i\)</span> is the index of one of the unlinked pages.</p>
<p>Here is an example of what such a matrix would look like with <span class="math notranslate nohighlight">\(n=5\)</span>, page 1 linking to pages 2 and 5, page 2 linking to page 5, page 3 linking to page 2, page 4 linking to pages 1 and 2, and page 5 linking to all other pages.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\left[ \begin{array}{ccccc} 
0 &amp; 0.05 &amp; 0.05 &amp; 0.45 &amp; 0.25 \\ 
0.45 &amp; 0 &amp; 0.85 &amp; 0.45 &amp; 0.25  \\
0.05 &amp; 0.05 &amp; 0 &amp; 0.05 &amp; 0.25  \\
0.05 &amp; 0.05 &amp; 0.05 &amp; 0 &amp; 0.25  \\
0.45 &amp; 0.85 &amp; 0.05 &amp; 0.05 &amp; 0  \\
\end{array}\right]
\end{equation}
\end{split}\]</div>
<p>To complete the model example, we specify <span class="math notranslate nohighlight">\(X_0\)</span>.  In this case the interpretation is easiest if we take <span class="math notranslate nohighlight">\(X_0\)</span> to be a vector with a one entry equal to one, and all other entries equal to zero.  For example, the following choice of <span class="math notranslate nohighlight">\(X_0\)</span> means that the browser starts the navigation at page 4.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
X_0 = \left[ \begin{array}{ccccc} 0 \\ 0 \\ 0 \\ 1 \\ 0
\end{array}\right]
\end{equation}
\end{split}\]</div>
<p>Applying the transformation once gives <span class="math notranslate nohighlight">\(X_1 = AX_0\)</span> which gives a vector that contains the probabilities that the browser is at each of the pages.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.45</span><span class="p">,</span><span class="mf">0.25</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.45</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.85</span><span class="p">,</span><span class="mf">0.45</span><span class="p">,</span><span class="mf">0.25</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.25</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.25</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.45</span><span class="p">,</span><span class="mf">0.85</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">X_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">X_1</span> <span class="o">=</span> <span class="n">A</span><span class="nd">@X_0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.45]
 [0.45]
 [0.05]
 [0.  ]
 [0.05]]
</pre></div>
</div>
</div>
</div>
<p>Applying the transformation <span class="math notranslate nohighlight">\(n\)</span> times gives <span class="math notranslate nohighlight">\(X_n\)</span>, the vector that contains the probabilities of the browser being at each of the pages after <span class="math notranslate nohighlight">\(n\)</span> steps of navigation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="nd">@X</span>
    
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.15277035]
 [0.29525499]
 [0.11062482]
 [0.11062482]
 [0.33072501]]
</pre></div>
</div>
</div>
</div>
<p>As with the population model, the interest lies in predicting the probabilities in <span class="math notranslate nohighlight">\(X_n\)</span> when <span class="math notranslate nohighlight">\(n\)</span> is large, and thus determining what pages a browser is more likely to visit after this sort of random navigation.</p>
</div>
<div class="section" id="id1">
<h3>Exercises<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>The webpages and their links are an example of a <a class="reference internal" href="Applications.html"><span class="doc std std-doc">directed graph</span></a> as discussed in an earlier chapter.  An adjacency matrix therefore could be used to conveniently describe the link structure among the pages.  The matrix used in the web navigation model could then be constructed from the adjacency matrix.  Write a Python function that accepts an adjacency matrix for a direct graph, and returns a the matrix required for the corresponding web navigation model.  Test your function on the following adjacency matrix defined in the cell below.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
             <span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Code solution here.</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Allen, Linda J.S. <em>Some Discrete SI, SIR, and SIS epidemic models</em>., Mathematical Biosciences, Vol 124, No. 1, Nov. 1994, pp. 83-105.</p></li>
<li><p>Kwak, Jin Ho and Sungpyo Hong.  <em>Linear Algebra</em>. 2nd ed., Birkhauser., 2004.</p></li>
<li><p>Lay, David, et al. <em>Linear Algebra and its Applications</em>. 5th ed., Pearson., 2016</p></li>
<li><p>Leon, Steven J. <em>Linear Algebra with Applications</em>. 9th ed., Pearson., 2015</p></li>
<li><p>John Vince. <em>Mathematics for Computer Graphics</em>. 3rd ed., Springer., 2010</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "bvanderlei/jupyter-guide-to-linear-algebra",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="Planar_Transformations.html" title="previous page">Transformations in a Plane</a>
    <a class='right-next' id="next-link" href="Inner_Products.html" title="next page">Inner Products</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Ben Vanderlei<br/>
        
          <div class="extra_footer">
            <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Jupyter Guide to Linear Algebra</span> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.
          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>